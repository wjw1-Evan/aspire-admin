---
description: é”™è¯¯æ¶ˆæ¯è§„èŒƒ - ä½¿ç”¨ ErrorMessages å¸¸é‡ç±»
globs: Platform.ApiService/Controllers/*.cs,Platform.ApiService/Services/*.cs
---

# é”™è¯¯æ¶ˆæ¯ä½¿ç”¨è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

ä½¿ç”¨ `ErrorMessages` å¸¸é‡ç±»ç®¡ç†æ‰€æœ‰é”™è¯¯å’ŒæˆåŠŸæ¶ˆæ¯ï¼Œç¦æ­¢ç¡¬ç¼–ç å­—ç¬¦ä¸²ã€‚

## âœ… æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼

```csharp
using Platform.ApiService.Constants;

// æˆåŠŸæ¶ˆæ¯
return Success(data, ErrorMessages.CreateSuccess);
return Success(ErrorMessages.UpdateSuccess);
return Success(ErrorMessages.DeleteSuccess);
return Success(ErrorMessages.OperationSuccess);

// æ ¼å¼åŒ–æ¶ˆæ¯
throw new KeyNotFoundException(
    string.Format(ErrorMessages.ResourceNotFound, "ç”¨æˆ·")
);

throw new ArgumentException(
    string.Format(ErrorMessages.ParameterRequired, "ç”¨æˆ·å")
);

throw new InvalidOperationException(
    string.Format(ErrorMessages.ResourceAlreadyExists, "è§’è‰²åç§°")
);

// ç›´æ¥ä½¿ç”¨å¸¸é‡
throw new UnauthorizedAccessException(ErrorMessages.Unauthorized);
throw new InvalidOperationException(ErrorMessages.CannotDeleteSelf);
throw new InvalidOperationException(ErrorMessages.CannotModifyOwnRole);
```

## âŒ ç¦æ­¢çš„åšæ³•

```csharp
// âŒ ä¸è¦ç¡¬ç¼–ç æˆåŠŸæ¶ˆæ¯
return Success(data, "åˆ›å»ºæˆåŠŸ");
return Success("æ“ä½œæˆåŠŸ");

// âŒ ä¸è¦ç¡¬ç¼–ç é”™è¯¯æ¶ˆæ¯
throw new KeyNotFoundException($"ç”¨æˆ· {id} ä¸å­˜åœ¨");
throw new ArgumentException("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
throw new InvalidOperationException("è§’è‰²åç§°å·²å­˜åœ¨");

// âŒ ä¸è¦åœ¨ä»£ç ä¸­ç›´æ¥æ‹¼æ¥é”™è¯¯æ¶ˆæ¯
throw new InvalidOperationException($"ä¸èƒ½åˆ é™¤æœ‰ {count} ä¸ªå­èœå•çš„èœå•");
```

## ğŸ“‹ å¸¸ç”¨ ErrorMessages å¸¸é‡

### æ“ä½œç»“æœ
```csharp
ErrorMessages.OperationSuccess      // "æ“ä½œæˆåŠŸ"
ErrorMessages.OperationFailed       // "æ“ä½œå¤±è´¥"
ErrorMessages.CreateSuccess         // "åˆ›å»ºæˆåŠŸ"
ErrorMessages.UpdateSuccess         // "æ›´æ–°æˆåŠŸ"
ErrorMessages.DeleteSuccess         // "åˆ é™¤æˆåŠŸ"
```

### èµ„æºç›¸å…³ï¼ˆéœ€è¦æ ¼å¼åŒ–ï¼‰
```csharp
ErrorMessages.ResourceNotFound      // "{0}ä¸å­˜åœ¨"
ErrorMessages.ResourceAlreadyExists // "{0}å·²å­˜åœ¨"

// ä½¿ç”¨æ–¹å¼
string.Format(ErrorMessages.ResourceNotFound, "ç”¨æˆ·")
string.Format(ErrorMessages.ResourceAlreadyExists, "è§’è‰²åç§°")
```

### å‚æ•°éªŒè¯ï¼ˆéœ€è¦æ ¼å¼åŒ–ï¼‰
```csharp
ErrorMessages.ParameterRequired     // "{0}ä¸èƒ½ä¸ºç©º"
ErrorMessages.ParameterInvalid      // "{0}æ ¼å¼ä¸æ­£ç¡®"
ErrorMessages.ParameterTooLong      // "{0}é•¿åº¦ä¸èƒ½è¶…è¿‡{1}ä¸ªå­—ç¬¦"
ErrorMessages.ParameterTooShort     // "{0}é•¿åº¦ä¸èƒ½å°‘äº{1}ä¸ªå­—ç¬¦"

// ä½¿ç”¨æ–¹å¼
string.Format(ErrorMessages.ParameterRequired, "ç”¨æˆ·å")
string.Format(ErrorMessages.ParameterTooLong, "æè¿°", 200)
```

### æƒé™ç›¸å…³
```csharp
ErrorMessages.Unauthorized          // "æ— æƒæ‰§è¡Œæ­¤æ“ä½œ"
ErrorMessages.PermissionDenied      // "æƒé™ä¸è¶³"
ErrorMessages.NotAuthenticated      // "æœªæ‰¾åˆ°ç”¨æˆ·ä¿¡æ¯"
```

### ä¸šåŠ¡è§„åˆ™
```csharp
ErrorMessages.CannotDeleteSelf              // "ä¸èƒ½åˆ é™¤è‡ªå·±çš„è´¦æˆ·"
ErrorMessages.CannotModifyOwnRole           // "ä¸èƒ½ä¿®æ”¹è‡ªå·±çš„è§’è‰²"
ErrorMessages.SystemRoleCannotDelete        // "ä¸èƒ½åˆ é™¤ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²"
ErrorMessages.CannotRemoveLastAdmin         // "ä¸èƒ½ç§»é™¤æœ€åä¸€ä¸ªç®¡ç†å‘˜çš„è§’è‰²"
ErrorMessages.CannotDeleteMenuWithChildren  // "ä¸èƒ½åˆ é™¤æœ‰å­èœå•çš„èœå•ï¼Œè¯·å…ˆåˆ é™¤å­èœå•"
```

### éªŒè¯æ¶ˆæ¯
```csharp
ErrorMessages.InvalidEmailFormat    // "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"
ErrorMessages.InvalidPhoneFormat    // "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"
ErrorMessages.InvalidUsernameFormat // "ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®"
ErrorMessages.PasswordTooShort      // "å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä¸ªå­—ç¬¦"
ErrorMessages.PasswordTooLong       // "å¯†ç é•¿åº¦ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦"
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä¼˜å…ˆä½¿ç”¨å¸¸é‡
```csharp
// âœ… å¥½
return Success(ErrorMessages.CreateSuccess);

// âŒ å·®
return Success("åˆ›å»ºæˆåŠŸ");
```

### 2. éœ€è¦æ ¼å¼åŒ–æ—¶ä½¿ç”¨ string.Format
```csharp
// âœ… å¥½
throw new KeyNotFoundException(
    string.Format(ErrorMessages.ResourceNotFound, "ç”¨æˆ·")
);

// âŒ å·®
throw new KeyNotFoundException($"ç”¨æˆ· {id} ä¸å­˜åœ¨");
```

### 3. é…åˆ ResourceExtensions ä½¿ç”¨
```csharp
// âœ… æœ€ä½³å®è·µ
var user = await _service.GetUserByIdAsync(id);
return Success(user.EnsureFound("ç”¨æˆ·", id));

// ResourceExtensions.EnsureFound ä¼šä½¿ç”¨ ErrorMessages.ResourceNotFound
```

## ğŸ¯ æ·»åŠ æ–°çš„é”™è¯¯æ¶ˆæ¯

å¦‚æœéœ€è¦æ·»åŠ æ–°çš„é”™è¯¯æ¶ˆæ¯ï¼Œåœ¨ [UserConstants.cs](mdc:Platform.ApiService/Constants/UserConstants.cs) çš„ `ErrorMessages` ç±»ä¸­æ·»åŠ ï¼š

```csharp
public static class ErrorMessages
{
    // ç°æœ‰å¸¸é‡...
    
    // æ·»åŠ æ–°å¸¸é‡
    public const string YourNewMessage = "ä½ çš„æ–°æ¶ˆæ¯";
    public const string YourFormattedMessage = "{0} çš„æ ¼å¼åŒ–æ¶ˆæ¯ {1}";
}
```

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [ErrorMessages å®šä¹‰](mdc:Platform.ApiService/Constants/UserConstants.cs)
- [åŸºç¡€ç»„ä»¶ä½¿ç”¨æŒ‡å—](mdc:docs/optimization/BASE-COMPONENTS-GUIDE.md)
- [v5.0 ä¼˜åŒ–å‰åå¯¹æ¯”](mdc:docs/optimization/V5-BEFORE-AFTER-COMPARISON.md)
