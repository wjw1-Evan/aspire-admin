---
globs: **/Platform.App/**,**/app/**,**/components/**,**/hooks/**,**/services/**,Platform.App/**/*.tsx,Platform.App/**/*.ts,*.tsx,*.ts,*.js,*.jsx,app.json,expo-env.d.ts
description: React Native å’Œ Expo ç§»åŠ¨ç«¯å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ - ç»„ä»¶å¼€å‘ã€è·¯ç”±ã€çŠ¶æ€ç®¡ç†ã€æ€§èƒ½ä¼˜åŒ–
---

# ç§»åŠ¨ç«¯å¼€å‘æ¨¡å¼å’Œæœ€ä½³å®è·µ

## ğŸ¯ æ¦‚è¿°

åŸºäº React Native + Expo æŠ€æœ¯æ ˆï¼Œæä¾›ç»Ÿä¸€çš„ç§»åŠ¨ç«¯å¼€å‘æ¨¡å¼å’Œæœ€ä½³å®è·µã€‚

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

**ä½¿ç”¨ React Native + Expo æ„å»ºè·¨å¹³å°ç§»åŠ¨åº”ç”¨ï¼Œéµå¾ªç§»åŠ¨ç«¯æœ€ä½³å®è·µï¼Œè€ƒè™‘æ€§èƒ½ã€ç”¨æˆ·ä½“éªŒå’Œè·¨å¹³å°å…¼å®¹æ€§**

## ğŸ¨ é£æ ¼ä¸äº¤äº’åŸºçº¿ï¼ˆå¯¹é½å¾®ä¿¡ï¼‰

- **è§†è§‰åŸºè°ƒ**ï¼šä¸»è‰²ã€èƒŒæ™¯ã€å­—ä½“ã€åœ†è§’ã€é—´è·ç­‰éœ€åŒ¹é…å¾®ä¿¡åŸç”Ÿè§†è§‰è§„èŒƒï¼ˆæµ…è‰²æ¨¡å¼ä»¥ç™½/æµ…ç°+å¾®ä¿¡ç»¿è‰² `#07C160` ä¸ºä¸»ï¼Œæ·±è‰²æ¨¡å¼éµå¾ªå¾®ä¿¡å¤œé—´ä¸»é¢˜ï¼‰ã€‚
- **ç»„ä»¶æ ·å¼**ï¼šé¡¶éƒ¨å¯¼èˆªã€åº•éƒ¨ Tabã€åˆ—è¡¨é¡¹ã€æŒ‰é’®ã€è¾“å…¥æ¡†ã€å¼¹çª—ã€æ°”æ³¡ç­‰å¤–è§‚éœ€ä¸å¾®ä¿¡ä¸€è‡´ï¼›å¦‚æ— è®¾è®¡ç¨¿ï¼Œè¯·å‚è€ƒæœ€æ–°ç‰ˆå¾®ä¿¡çš„ iOS/Android UI è¡¨ç°ã€‚
- **äº¤äº’è¡Œä¸º**ï¼šæ‰‹åŠ¿ã€åŠ¨æ•ˆã€åŠ è½½åé¦ˆã€äºŒçº§é¡µé¢è¿”å›ã€ä¸‹æ‹‰åˆ·æ–°ã€æ»‘åŠ¨åˆ é™¤ç­‰äº¤äº’é€»è¾‘ä¿æŒä¸å¾®ä¿¡ç›¸åŒï¼Œå«åŠ¨ç”»æ—¶é•¿ã€ç¼“åŠ¨å’Œåé¦ˆæ–¹å¼ã€‚
- **å›¾æ ‡ä¸æ’ç”»**ï¼šä¼˜å…ˆä½¿ç”¨ä¸å¾®ä¿¡é£æ ¼ä¸€è‡´çš„çº¿æ€§/å®å¿ƒå›¾æ ‡ï¼Œå°ºå¯¸/çº¿å®½ç»Ÿä¸€ï¼›å¦‚éœ€è‡ªå®šä¹‰ï¼Œä¿æŒå¾®ä¿¡çš„è§†è§‰è¯­è¨€ã€‚
- **æ–‡æ¡ˆè¯­æ°”**ï¼šæç¤ºä¸æŒ‰é’®æ–‡æ¡ˆéµå¾ªå¾®ä¿¡ç®€æ´å‹å¥½çš„è¯­æ°”ï¼ˆå¦‚â€œç¡®å®š/å–æ¶ˆâ€â€œæäº¤åé¦ˆâ€â€œæš‚ä¸â€ï¼‰ã€‚
- **æµ‹è¯•è¦æ±‚**ï¼šæ–°é¡µé¢æˆ–ç»„ä»¶ä¸Šçº¿å‰ï¼Œéœ€åœ¨çœŸæœºå¯¹ç…§å¾®ä¿¡å…¥å£è¿›è¡Œè§†è§‰å’Œäº¤äº’èµ°æŸ¥ï¼Œç¡®ä¿ä½“éªŒä¸€è‡´æ€§ã€‚

## ğŸ—ï¸ ç§»åŠ¨ç«¯æ¶æ„

### Expo Router è·¯ç”±ç³»ç»Ÿ

```typescript
// âœ… Expo Router æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ç»“æ„
// app/
//   â”œâ”€â”€ (auth)/
//   â”‚   â”œâ”€â”€ login.tsx
//   â”‚   â””â”€â”€ register.tsx
//   â”œâ”€â”€ (tabs)/
//   â”‚   â”œâ”€â”€ index.tsx       // ä¸»é¡µé¢
//   â”‚   â”œâ”€â”€ profile.tsx     // ä¸ªäººèµ„æ–™é¡µé¢
//   â”‚   â””â”€â”€ settings.tsx    // è®¾ç½®é¡µé¢
//   â”œâ”€â”€ _layout.tsx         // æ ¹å¸ƒå±€
//   â””â”€â”€ +not-found.tsx      // 404 é¡µé¢

// âœ… æ ¹å¸ƒå±€é…ç½®
// app/_layout.tsx
import { Stack } from 'expo-router';
import { AuthProvider } from '@/contexts/AuthContext';
import { ThemeProvider } from '@/contexts/ThemeContext';
import { StatusBar } from 'expo-status-bar';

export default function RootLayout() {
  return (
    <ThemeProvider>
      <AuthProvider>
        <StatusBar style="auto" />
        <Stack screenOptions={{ headerShown: false }}>
          <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
          <Stack.Screen name="login" options={{ title: 'ç™»å½•' }} />
          <Stack.Screen name="register" options={{ title: 'æ³¨å†Œ' }} />
        </Stack>
      </AuthProvider>
    </ThemeProvider>
  );
}

// âœ… æ ‡ç­¾é¡µå¸ƒå±€
// app/(tabs)/_layout.tsx
import { Tabs } from 'expo-router';
import { Ionicons } from '@expo/vector-icons';

export default function TabLayout() {
  return (
    <Tabs screenOptions={{ headerShown: false }}>
      <Tabs.Screen 
        name="index" 
        options={{ 
          title: 'é¦–é¡µ',
          tabBarIcon: ({ color }) => <Ionicons name="home" size={24} color={color} />
        }} 
      />
      <Tabs.Screen 
        name="profile" 
        options={{ 
          title: 'ä¸ªäºº',
          tabBarIcon: ({ color }) => <Ionicons name="person" size={24} color={color} />
        }} 
      />
    </Tabs>
  );
}
```

### å¯¼èˆªå®ˆå«æ¨¡å¼

```typescript
// âœ… å¯¼èˆªå®ˆå«å®ç°
export function AuthGuard({ children }: { children: React.ReactNode }) {
  const { isAuthenticated, isLoading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!isLoading && !isAuthenticated) {
      router.replace('/(auth)/login');
    }
  }, [isAuthenticated, isLoading, router]);

  if (isLoading) {
    return <LoadingScreen />;
  }

  if (!isAuthenticated) {
    return null;
  }

  return <>{children}</>;
}

// ä½¿ç”¨ç¤ºä¾‹
export default function TabLayout() {
  return (
    <AuthGuard>
      <Tabs>
        <Tabs.Screen name="index" options={{ title: 'é¦–é¡µ' }} />
        <Tabs.Screen name="profile" options={{ title: 'ä¸ªäººä¸­å¿ƒ' }} />
      </Tabs>
    </AuthGuard>
  );
}
```

## ğŸ¨ ç»„ä»¶å¼€å‘è§„èŒƒ

### ç»Ÿä¸€æ ·å¼ç³»ç»Ÿï¼ˆAppStylesï¼‰

**æ‰€æœ‰é¡µé¢å¿…é¡»ä½¿ç”¨ç»Ÿä¸€çš„æ ·å¼ç³»ç»Ÿï¼Œç¡®ä¿æ•´ä¸ªåº”ç”¨çš„è®¾è®¡ä¸€è‡´æ€§ã€‚**

#### 1. ä½¿ç”¨ AppStyles å¸¸é‡

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ ·å¼å¸¸é‡
// constants/AppStyles.ts
import { AppStyles, commonStyles } from '../../constants/AppStyles';

// ä½¿ç”¨é¢œè‰²
<View style={{ backgroundColor: AppStyles.colors.primary }} />

// ä½¿ç”¨é—´è·
<View style={{ padding: AppStyles.spacing.md }} />

// ä½¿ç”¨åœ†è§’
<View style={{ borderRadius: AppStyles.borderRadius.lg }} />

// ä½¿ç”¨é€šç”¨æ ·å¼
<View style={commonStyles.card} />
<View style={commonStyles.cardHeader} />
```

#### 2. ç»Ÿä¸€æ ·å¼å¸¸é‡

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ ·å¼å¸¸é‡
export const AppStyles = {
    colors: {
        primary: '#667eea',
        background: '#f5f7fa',
        cardBackground: '#fff',
        text: '#333',
        textSecondary: '#666',
        // ...
    },
    gradients: {
        primary: ['#667eea', '#764ba2', '#f093fb'],
    },
    spacing: {
        xs: 4, sm: 8, md: 16, lg: 24, xl: 32,
    },
    borderRadius: {
        sm: 8, md: 12, lg: 16, xl: 24,
    },
    fontSize: {
        xs: 12, sm: 14, md: 16, lg: 18, xl: 20,
    },
    shadows: {
        sm: { /* ... */ },
        md: { /* ... */ },
        lg: { /* ... */ },
    },
};
```

#### 3. ä½¿ç”¨é€šç”¨æ ·å¼

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ commonStyles
import { commonStyles } from '../../constants/AppStyles';

// æ¸å˜å¤´éƒ¨
<LinearGradient
    colors={AppStyles.gradients.primary}
    style={commonStyles.gradientHeader}
>
    {/* å¤´éƒ¨å†…å®¹ */}
</LinearGradient>

// å¡ç‰‡
<View style={commonStyles.card}>
    <View style={commonStyles.cardHeader}>
        <Text style={commonStyles.cardTitle}>æ ‡é¢˜</Text>
    </View>
    {/* å¡ç‰‡å†…å®¹ */}
</View>

// ä¿¡æ¯è¡Œ
<View style={commonStyles.infoRow}>
    <View style={commonStyles.infoIconContainer}>
        <Ionicons name="icon" size={16} color={AppStyles.colors.primary} />
    </View>
    <Text style={commonStyles.infoLabel}>æ ‡ç­¾</Text>
    <Text style={commonStyles.infoValue}>å€¼</Text>
</View>
```

#### 4. ç¦æ­¢çš„åšæ³•

```tsx
// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç é¢œè‰²å’Œé—´è·
<View style={{ 
    backgroundColor: '#667eea',
    padding: 20,
    borderRadius: 16,
}} />

// âŒ é”™è¯¯ï¼šæ¯ä¸ªé¡µé¢å®šä¹‰è‡ªå·±çš„æ ·å¼å¸¸é‡
const localColors = {
    primary: '#667eea',
    // ...
};

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ ·å¼å¸¸é‡
<View style={{ 
    backgroundColor: AppStyles.colors.primary,
    padding: AppStyles.spacing.lg,
    borderRadius: AppStyles.borderRadius.lg,
}} />
```

### ç»Ÿä¸€é¡µé¢å®½åº¦ï¼ˆPageContainerï¼‰

**æ‰€æœ‰é¡µé¢å¿…é¡»ä½¿ç”¨ `PageContainer` ç»„ä»¶åŒ…è£…ï¼Œç¡®ä¿åœ¨ Web å¹³å°ä¸‹ç»Ÿä¸€å®½åº¦é™åˆ¶å¹¶å±…ä¸­æ˜¾ç¤ºï¼Œç§»åŠ¨ç«¯ä¿æŒå…¨å±æ˜¾ç¤ºã€‚**

#### 1. PageContainer ç»„ä»¶

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ PageContainer åŒ…è£…é¡µé¢å†…å®¹
// app/(tabs)/index.tsx
import PageContainer from '../../components/PageContainer';

export default function HomeScreen() {
  return (
    <PageContainer>
      <View style={styles.container}>
        {/* é¡µé¢å†…å®¹ */}
      </View>
    </PageContainer>
  );
}
```

#### 2. PageContainer ç‰¹æ€§

- **Web å¹³å°**ï¼š
  - æœ€å¤§å®½åº¦ï¼š428pxï¼ˆiPhone 14 Pro Max å®½åº¦ï¼‰
  - æ°´å¹³å±…ä¸­æ˜¾ç¤º
  - ä¸Šä¸‹å†…è¾¹è·ï¼š20px
  - é˜´å½±æ•ˆæœï¼Œæ¨¡æ‹Ÿæ‰‹æœºå±å¹•
- **ç§»åŠ¨ç«¯ï¼ˆiOS/Androidï¼‰**ï¼š
  - å…¨å±æ˜¾ç¤º
  - æ— å®½åº¦é™åˆ¶

#### 3. ä½¿ç”¨åœºæ™¯

```tsx
// âœ… æ­£ç¡®ï¼šæ‰€æœ‰é¡µé¢éƒ½ä½¿ç”¨ PageContainer
// app/(auth)/login.tsx
import PageContainer from '../../components/PageContainer';

export default function LoginScreen() {
  return (
    <PageContainer>
      <KeyboardAvoidingView style={styles.container}>
        <ScrollView>
          {/* ç™»å½•è¡¨å• */}
        </ScrollView>
      </KeyboardAvoidingView>
    </PageContainer>
  );
}

// âœ… æ­£ç¡®ï¼šåŠ è½½çŠ¶æ€ä¹Ÿä½¿ç”¨ PageContainer
export default function ProfileScreen() {
  if (loading) {
    return (
      <PageContainer>
        <View style={styles.loadingContainer}>
          <ActivityIndicator size="large" />
        </View>
      </PageContainer>
    );
  }

  return (
    <PageContainer>
      <SafeAreaView style={styles.container}>
        {/* é¡µé¢å†…å®¹ */}
      </SafeAreaView>
    </PageContainer>
  );
}
```

#### 4. ç¦æ­¢çš„åšæ³•

```tsx
// âŒ é”™è¯¯ï¼šä¸ä½¿ç”¨ PageContainer
export default function HomeScreen() {
  return (
    <View style={styles.container}>
      {/* é¡µé¢å†…å®¹ */}
    </View>
  );
}

// âŒ é”™è¯¯ï¼šæ‰‹åŠ¨å®ç°å®½åº¦é™åˆ¶
const styles = StyleSheet.create({
  container: {
    ...Platform.select({
      web: {
        maxWidth: 428,
        alignSelf: 'center',
      },
    }),
  },
});
```

### åŸºç¡€ç»„ä»¶ç¤ºä¾‹

```tsx
// âœ… æ¨èï¼šç§»åŠ¨ç«¯ç»„ä»¶ç»“æ„
import React from 'react';
import { View, Text, StyleSheet, TouchableOpacity } from 'react-native';
import { Ionicons } from '@expo/vector-icons';

interface UserCardProps {
  user: User;
  onPress?: (user: User) => void;
  onEdit?: (user: User) => void;
}

const UserCard: React.FC<UserCardProps> = ({ user, onPress, onEdit }) => {
  const handlePress = () => {
    onPress?.(user);
  };

  const handleEdit = () => {
    onEdit?.(user);
  };

  return (
    <TouchableOpacity style={styles.container} onPress={handlePress}>
      <View style={styles.content}>
        <Text style={styles.name}>{user.username}</Text>
        <Text style={styles.email}>{user.email}</Text>
        <Text style={styles.role}>{user.role}</Text>
      </View>
      <TouchableOpacity onPress={handleEdit} style={styles.editButton}>
        <Ionicons name="pencil" size={20} color="#007AFF" />
      </TouchableOpacity>
    </TouchableOpacity>
  );
};

const styles = StyleSheet.create({
  container: {
    flexDirection: 'row',
    backgroundColor: '#fff',
    padding: 16,
    marginVertical: 4,
    marginHorizontal: 16,
    borderRadius: 8,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 3,
  },
  content: {
    flex: 1,
  },
  name: {
    fontSize: 16,
    fontWeight: '600',
    color: '#000',
  },
  email: {
    fontSize: 14,
    color: '#666',
    marginTop: 4,
  },
  role: {
    fontSize: 12,
    color: '#999',
    marginTop: 2,
  },
  editButton: {
    padding: 8,
  },
});

export default UserCard;
```

### è‡ªå®šä¹‰ Hooks

```tsx
// âœ… æ¨èï¼šç§»åŠ¨ç«¯è‡ªå®šä¹‰ Hook
import { useState, useEffect, useCallback } from 'react';
import Toast from 'react-native-toast-message';

const useUserList = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [loading, setLoading] = useState(false);
  const [refreshing, setRefreshing] = useState(false);

  const fetchUsers = useCallback(async (showLoading = true) => {
    if (showLoading) setLoading(true);
    
    try {
      const response = await getUserList();
      setUsers(response.data);
    } catch (error) {
      Toast.show({
        type: 'error',
        text1: 'é”™è¯¯',
        text2: 'è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥',
        position: 'top',
        visibilityTime: 3000,
      });
    } finally {
      setLoading(false);
    }
  }, []);

  const refreshUsers = useCallback(async () => {
    setRefreshing(true);
    await fetchUsers(false);
    setRefreshing(false);
  }, [fetchUsers]);

  const deleteUser = useCallback(async (userId: string) => {
    try {
      await deleteUserById(userId);
      setUsers(prev => prev.filter(user => user.id !== userId));
      Toast.show({
        type: 'success',
        text1: 'æˆåŠŸ',
        text2: 'ç”¨æˆ·åˆ é™¤æˆåŠŸ',
        position: 'top',
        visibilityTime: 2000,
      });
    } catch (error) {
      Toast.show({
        type: 'error',
        text1: 'é”™è¯¯',
        text2: 'åˆ é™¤ç”¨æˆ·å¤±è´¥',
        position: 'top',
        visibilityTime: 3000,
      });
    }
  }, []);

  useEffect(() => {
    fetchUsers();
  }, [fetchUsers]);

  return {
    users,
    loading,
    refreshing,
    fetchUsers,
    refreshUsers,
    deleteUser,
  };
};
```

## ğŸš¨ é”™è¯¯æç¤ºå’Œæ¶ˆæ¯é€šçŸ¥

### ä½¿ç”¨ Expo Toastï¼ˆreact-native-toast-messageï¼‰

**ç¦æ­¢ä½¿ç”¨ `Alert.alert()` å’Œ `window.alert()`ï¼Œç»Ÿä¸€ä½¿ç”¨ `react-native-toast-message` æ˜¾ç¤ºé”™è¯¯æç¤ºå’Œæ¶ˆæ¯é€šçŸ¥ã€‚**

#### 1. æ ¹å¸ƒå±€é…ç½®

```tsx
// âœ… æ­£ç¡®ï¼šåœ¨æ ¹å¸ƒå±€ä¸­é…ç½® Toast
// app/_layout.tsx
import Toast from 'react-native-toast-message';

export default function RootLayout() {
  return (
    <ThemeProvider>
      <Stack>
        <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
        <Stack.Screen name="(auth)" options={{ headerShown: false }} />
      </Stack>
      <Toast /> {/* å¿…é¡»åœ¨æ ¹å¸ƒå±€ä¸­æ·»åŠ  Toast ç»„ä»¶ */}
    </ThemeProvider>
  );
}
```

#### 2. æ˜¾ç¤ºé”™è¯¯æç¤º

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Toast æ˜¾ç¤ºé”™è¯¯
import Toast from 'react-native-toast-message';

const handleLogin = async () => {
  try {
    const response = await authService.login(credentials);
    if (!response.success) {
      Toast.show({
        type: 'error',
        text1: 'ç™»å½•å¤±è´¥',
        text2: response.errorMessage || 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯',
        position: 'top',
        visibilityTime: 3000,
      });
      return;
    }
    // ç™»å½•æˆåŠŸå¤„ç†
  } catch (error: any) {
    Toast.show({
      type: 'error',
      text1: 'é”™è¯¯',
      text2: error.message || 'ç™»å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•',
      position: 'top',
      visibilityTime: 3000,
    });
  }
};
```

#### 3. æ˜¾ç¤ºæˆåŠŸæç¤º

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Toast æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
Toast.show({
  type: 'success',
  text1: 'æˆåŠŸ',
  text2: 'æ“ä½œå·²æˆåŠŸå®Œæˆ',
  position: 'top',
  visibilityTime: 2000,
});
```

#### 4. æ˜¾ç¤ºä¿¡æ¯æç¤º

```tsx
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Toast æ˜¾ç¤ºä¿¡æ¯
Toast.show({
  type: 'info',
  text1: 'æç¤º',
  text2: 'è¿™æ˜¯ä¸€æ¡ä¿¡æ¯æç¤º',
  position: 'top',
  visibilityTime: 3000,
});
```

#### 5. è¡¨å•éªŒè¯é”™è¯¯

```tsx
// âœ… æ­£ç¡®ï¼šè¡¨å•éªŒè¯ä½¿ç”¨ Toast
const handleSubmit = () => {
  if (!username.trim() || !password.trim()) {
    Toast.show({
      type: 'error',
      text1: 'éªŒè¯å¤±è´¥',
      text2: 'è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ',
      position: 'top',
      visibilityTime: 3000,
    });
    return;
  }
  // æäº¤è¡¨å•
};
```

#### 6. åˆ›å»º Toast å·¥å…·å‡½æ•°ï¼ˆå¯é€‰ï¼‰

```tsx
// âœ… æ¨èï¼šåˆ›å»º Toast å·¥å…·å‡½æ•°
// utils/toast.ts
import Toast from 'react-native-toast-message';

export const showError = (message: string, title = 'é”™è¯¯') => {
  Toast.show({
    type: 'error',
    text1: title,
    text2: message,
    position: 'top',
    visibilityTime: 3000,
  });
};

export const showSuccess = (message: string, title = 'æˆåŠŸ') => {
  Toast.show({
    type: 'success',
    text1: title,
    text2: message,
    position: 'top',
    visibilityTime: 2000,
  });
};

export const showInfo = (message: string, title = 'æç¤º') => {
  Toast.show({
    type: 'info',
    text1: title,
    text2: message,
    position: 'top',
    visibilityTime: 3000,
  });
};

// ä½¿ç”¨ç¤ºä¾‹
import { showError, showSuccess } from '@/utils/toast';

showError('ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç ');
showSuccess('æ“ä½œæˆåŠŸ');
```

### âŒ ç¦æ­¢çš„åšæ³•

```tsx
// âŒ ç¦æ­¢ï¼šä½¿ç”¨ Alert.alert()
import { Alert } from 'react-native';

const handleLogin = async () => {
  try {
    await login();
  } catch (error) {
    Alert.alert('é”™è¯¯', 'ç™»å½•å¤±è´¥'); // âŒ ç¦æ­¢ä½¿ç”¨
  }
};

// âŒ ç¦æ­¢ï¼šä½¿ç”¨ window.alert()ï¼ˆWeb å¹³å°ï¼‰
if (Platform.OS === 'web') {
  window.alert('é”™è¯¯'); // âŒ ç¦æ­¢ä½¿ç”¨
}
```

### Toast é…ç½®é€‰é¡¹

```tsx
Toast.show({
  type: 'error' | 'success' | 'info',  // Toast ç±»å‹
  text1: string,                        // ä¸»æ ‡é¢˜
  text2?: string,                       // å‰¯æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
  position?: 'top' | 'bottom',          // æ˜¾ç¤ºä½ç½®ï¼Œé»˜è®¤ 'top'
  visibilityTime?: number,              // æ˜¾ç¤ºæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 4000
  topOffset?: number,                   // è·ç¦»é¡¶éƒ¨çš„åç§»é‡
  bottomOffset?: number,                // è·ç¦»åº•éƒ¨çš„åç§»é‡
  onShow?: () => void,                  // æ˜¾ç¤ºæ—¶çš„å›è°ƒ
  onHide?: () => void,                  // éšè—æ—¶çš„å›è°ƒ
  onPress?: () => void,                 // ç‚¹å‡»æ—¶çš„å›è°ƒ
});
```

## âœ… æ¨èåšæ³•

### 1. ä¸»é¢˜åŒ–ç»„ä»¶

```typescript
// âœ… ä¸»é¢˜åŒ–ç»„ä»¶
interface ThemedComponentProps {
  children: React.ReactNode;
  style?: ViewStyle;
}

export const ThemedView: React.FC<ThemedComponentProps> = ({ children, style }) => {
  const { theme } = useTheme();
  
  return (
    <View style={[styles.container, { backgroundColor: theme.colors.background }, style]}>
      {children}
    </View>
  );
};

export const ThemedText: React.FC<ThemedComponentProps & { variant?: 'title' | 'body' | 'caption' }> = ({ 
  children, 
  style, 
  variant = 'body' 
}) => {
  const { theme } = useTheme();
  
  const textStyle = variant === 'title' ? styles.title : 
                   variant === 'caption' ? styles.caption : 
                   styles.body;
  
  return (
    <Text style={[textStyle, { color: theme.colors.text }, style]}>
      {children}
    </Text>
  );
};
```

### 2. å¹³å°é€‚é…

```typescript
// âœ… å¹³å°é€‚é…
import { Platform, StatusBar } from 'react-native';

export const PlatformAdapter = {
  // çŠ¶æ€æ é«˜åº¦
  getStatusBarHeight: () => {
    return Platform.OS === 'ios' ? 44 : StatusBar.currentHeight || 0;
  },

  // å®‰å…¨åŒºåŸŸ
  getSafeAreaInsets: () => {
    return Platform.OS === 'ios' ? 
      { top: 44, bottom: 34, left: 0, right: 0 } :
      { top: 0, bottom: 0, left: 0, right: 0 };
  },

  // å¹³å°ç‰¹å®šæ ·å¼
  getPlatformStyle: (iosStyle: any, androidStyle: any) => {
    return Platform.OS === 'ios' ? iosStyle : androidStyle;
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const styles = StyleSheet.create({
  container: {
    paddingTop: PlatformAdapter.getStatusBarHeight(),
    ...PlatformAdapter.getPlatformStyle(
      { shadowColor: '#000', shadowOffset: { width: 0, height: 2 } },
      { elevation: 4 }
    )
  }
});
```

### 3. æ‰‹åŠ¿å¤„ç†

```typescript
// âœ… æ‰‹åŠ¿å¤„ç†
import { PanGestureHandler, State } from 'react-native-gesture-handler';

export const SwipeableCard: React.FC<{
  children: React.ReactNode;
  onSwipeLeft?: () => void;
  onSwipeRight?: () => void;
}> = ({ children, onSwipeLeft, onSwipeRight }) => {
  const translateX = useRef(new Animated.Value(0)).current;

  const onGestureEvent = Animated.event(
    [{ nativeEvent: { translationX: translateX } }],
    { useNativeDriver: true }
  );

  const onHandlerStateChange = (event: any) => {
    if (event.nativeEvent.state === State.END) {
      const { translationX, velocityX } = event.nativeEvent;
      
      if (translationX > 100 || velocityX > 500) {
        onSwipeRight?.();
      } else if (translationX < -100 || velocityX < -500) {
        onSwipeLeft?.();
      }
      
      Animated.spring(translateX, {
        toValue: 0,
        useNativeDriver: true
      }).start();
    }
  };

  return (
    <PanGestureHandler
      onGestureEvent={onGestureEvent}
      onHandlerStateChange={onHandlerStateChange}
    >
      <Animated.View style={{ transform: [{ translateX }] }}>
        {children}
      </Animated.View>
    </PanGestureHandler>
  );
};
```

### 4. ç¦»çº¿æ”¯æŒ

```typescript
// âœ… ç¦»çº¿æ”¯æŒ
export const useOfflineSupport = () => {
  const [isOnline, setIsOnline] = useState(true);
  const [offlineData, setOfflineData] = useState<any[]>([]);

  useEffect(() => {
    const unsubscribe = NetInfo.addEventListener(state => {
      setIsOnline(state.isConnected ?? false);
    });

    return unsubscribe;
  }, []);

  const syncOfflineData = useCallback(async () => {
    if (!isOnline || offlineData.length === 0) return;

    try {
      for (const data of offlineData) {
        await apiService.syncData(data);
      }
      setOfflineData([]);
    } catch (error) {
      console.error('Failed to sync offline data:', error);
    }
  }, [isOnline, offlineData]);

  const addOfflineData = useCallback((data: any) => {
    setOfflineData(prev => [...prev, { ...data, timestamp: Date.now() }]);
  }, []);

  return {
    isOnline,
    offlineData,
    syncOfflineData,
    addOfflineData
  };
};
```

### 5. æ€§èƒ½ä¼˜åŒ–

```typescript
// âœ… æ€§èƒ½ä¼˜åŒ–
export const OptimizedList: React.FC<{
  data: any[];
  renderItem: ({ item }: { item: any }) => React.ReactElement;
}> = ({ data, renderItem }) => {
  const keyExtractor = useCallback((item: any) => item.id, []);
  
  const getItemLayout = useCallback((data: any, index: number) => ({
    length: 80,
    offset: 80 * index,
    index
  }), []);

  return (
    <FlatList
      data={data}
      renderItem={renderItem}
      keyExtractor={keyExtractor}
      getItemLayout={getItemLayout}
      removeClippedSubviews={true}
      maxToRenderPerBatch={10}
      windowSize={10}
      initialNumToRender={10}
      updateCellsBatchingPeriod={50}
    />
  );
};

// å›¾ç‰‡ä¼˜åŒ–
export const OptimizedImage: React.FC<{
  source: { uri: string };
  style?: ImageStyle;
}> = ({ source, style }) => {
  return (
    <Image
      source={source}
      style={style}
      resizeMode="cover"
      loadingIndicatorSource={require('../assets/placeholder.png')}
      onError={() => console.log('Image load error')}
    />
  );
};
```

### 6. çŠ¶æ€ç®¡ç†

```typescript
// âœ… ç§»åŠ¨ç«¯çŠ¶æ€ç®¡ç†
interface AppState {
  user: User | null;
  theme: 'light' | 'dark';
  notifications: Notification[];
  isOnline: boolean;
}

type AppAction =
  | { type: 'SET_USER'; payload: User | null }
  | { type: 'SET_THEME'; payload: 'light' | 'dark' }
  | { type: 'ADD_NOTIFICATION'; payload: Notification }
  | { type: 'SET_ONLINE'; payload: boolean };

const appReducer = (state: AppState, action: AppAction): AppState => {
  switch (action.type) {
    case 'SET_USER':
      return { ...state, user: action.payload };
    case 'SET_THEME':
      return { ...state, theme: action.payload };
    case 'ADD_NOTIFICATION':
      return { ...state, notifications: [...state.notifications, action.payload] };
    case 'SET_ONLINE':
      return { ...state, isOnline: action.payload };
    default:
      return state;
  }
};

export const AppProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [state, dispatch] = useReducer(appReducer, initialState);

  const value = useMemo(() => ({
    state,
    dispatch,
    setUser: (user: User | null) => dispatch({ type: 'SET_USER', payload: user }),
    setTheme: (theme: 'light' | 'dark') => dispatch({ type: 'SET_THEME', payload: theme }),
    addNotification: (notification: Notification) => 
      dispatch({ type: 'ADD_NOTIFICATION', payload: notification }),
    setOnline: (isOnline: boolean) => dispatch({ type: 'SET_ONLINE', payload: isOnline })
  }), [state]);

  return (
    <AppContext.Provider value={value}>
      {children}
    </AppContext.Provider>
  );
};
```

## âŒ é¿å…çš„åšæ³•

### 1. ä¸è¦å¿½ç•¥å¹³å°å·®å¼‚

```typescript
// âŒ é”™è¯¯ï¼šå¿½ç•¥å¹³å°å·®å¼‚
const styles = StyleSheet.create({
  container: {
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.25,
    shadowRadius: 3.84,
    elevation: 5  // Android å’Œ iOS éƒ½ä½¿ç”¨
  }
});

// âœ… æ­£ç¡®ï¼šå¹³å°é€‚é…
const styles = StyleSheet.create({
  container: {
    ...Platform.select({
      ios: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.25,
        shadowRadius: 3.84,
      },
      android: {
        elevation: 5,
      },
    }),
  }
});
```

### 2. ä¸è¦å¿½ç•¥æ€§èƒ½ä¼˜åŒ–

```typescript
// âŒ é”™è¯¯ï¼šå¿½ç•¥æ€§èƒ½ä¼˜åŒ–
export const UserList: React.FC<{ users: User[] }> = ({ users }) => {
  return (
    <ScrollView>
      {users.map(user => (
        <UserCard key={user.id} user={user} />
      ))}
    </ScrollView>
  );
};

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ FlatList
export const UserList: React.FC<{ users: User[] }> = ({ users }) => {
  const renderItem = useCallback(({ item }: { item: User }) => (
    <UserCard user={item} />
  ), []);

  return (
    <FlatList
      data={users}
      renderItem={renderItem}
      keyExtractor={(item) => item.id}
    />
  );
};
```

### 3. ä¸è¦å¿½ç•¥å†…å­˜ç®¡ç†

```typescript
// âŒ é”™è¯¯ï¼šå¿½ç•¥å†…å­˜ç®¡ç†
export const ImageGallery: React.FC<{ images: string[] }> = ({ images }) => {
  const [currentIndex, setCurrentIndex] = useState(0);

  useEffect(() => {
    const timer = setInterval(() => {
      setCurrentIndex(prev => (prev + 1) % images.length);
    }, 3000);

    // å¿˜è®°æ¸…ç†å®šæ—¶å™¨
  }, [images.length]);

  return <Image source={{ uri: images[currentIndex] }} />;
};

// âœ… æ­£ç¡®ï¼šæ¸…ç†å‰¯ä½œç”¨
export const ImageGallery: React.FC<{ images: string[] }> = ({ images }) => {
  const [currentIndex, setCurrentIndex] = useState(0);

  useEffect(() => {
    const timer = setInterval(() => {
      setCurrentIndex(prev => (prev + 1) % images.length);
    }, 3000);

    return () => clearInterval(timer);
  }, [images.length]);

  return <Image source={{ uri: images[currentIndex] }} />;
};
```

### 4. ä¸è¦å¿½ç•¥æ»šåŠ¨é—®é¢˜

```tsx
// âŒ é”™è¯¯ï¼šScrollView é…ç½®ä¸å½“å¯¼è‡´æ— æ³•æ»šåŠ¨
<ScrollView style={{ flex: 1 }}>
    {/* å†…å®¹ */}
</ScrollView>

// âœ… æ­£ç¡®ï¼šç¡®ä¿ ScrollView å¯ä»¥æ­£å¸¸æ»šåŠ¨
<ScrollView
    style={[
        styles.scrollView,
        Platform.select({
            web: {
                overflowY: 'auto',
            },
            default: {},
        }),
    ]}
    contentContainerStyle={[
        styles.contentContainer,
        { flexGrow: 1 },
    ]}
>
    {/* å†…å®¹ */}
</ScrollView>

// âœ… æ­£ç¡®ï¼šPageContainer ä¸ä¼šé˜»æ­¢æ»šåŠ¨
// PageContainer ç»„ä»¶å·²ç»æ­£ç¡®é…ç½®ï¼Œä¸ä¼šé˜»æ­¢å­ç»„ä»¶çš„æ»šåŠ¨
<PageContainer>
    <ScrollView>
        {/* å†…å®¹ */}
    </ScrollView>
</PageContainer>
```

### 5. ä¸è¦å¿½ç•¥é”™è¯¯å¤„ç†

```typescript
// âŒ é”™è¯¯ï¼šå¿½ç•¥é”™è¯¯å¤„ç†
export const UserProfile: React.FC<{ userId: string }> = ({ userId }) => {
  const [user, setUser] = useState<User | null>(null);

  useEffect(() => {
    fetchUser(userId).then(setUser);
  }, [userId]);

  return <UserCard user={user} />;
};

// âœ… æ­£ç¡®ï¼šæ·»åŠ é”™è¯¯å¤„ç†å¹¶ä½¿ç”¨ Toast
import Toast from 'react-native-toast-message';

export const UserProfile: React.FC<{ userId: string }> = ({ userId }) => {
  const [user, setUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const loadUser = async () => {
      try {
        setLoading(true);
        setError(null);
        const userData = await fetchUser(userId);
        setUser(userData);
      } catch (err: any) {
        const errorMsg = err.message || 'åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥';
        setError(errorMsg);
        Toast.show({
          type: 'error',
          text1: 'é”™è¯¯',
          text2: errorMsg,
          position: 'top',
          visibilityTime: 3000,
        });
      } finally {
        setLoading(false);
      }
    };

    loadUser();
  }, [userId]);

  if (loading) return <LoadingSpinner />;
  if (error) return <ErrorMessage message={error} />;
  if (!user) return <NotFound />;

  return <UserCard user={user} />;
};
```

## ğŸ”§ æœ€ä½³å®è·µ

### 1. å“åº”å¼è®¾è®¡

```typescript
// âœ… å“åº”å¼è®¾è®¡
import { Dimensions } from 'react-native';

const { width, height } = Dimensions.get('window');

export const useResponsive = () => {
  const isTablet = width >= 768;
  const isLandscape = width > height;

  return {
    width,
    height,
    isTablet,
    isLandscape,
    screenWidth: width,
    screenHeight: height
  };
};

// ä½¿ç”¨ç¤ºä¾‹
export const ResponsiveLayout: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { isTablet } = useResponsive();

  return (
    <View style={[
      styles.container,
      isTablet ? styles.tabletContainer : styles.phoneContainer
    ]}>
      {children}
    </View>
  );
};
```

### 2. æ·±é“¾æ¥å¤„ç†

```typescript
// âœ… æ·±é“¾æ¥å¤„ç†
export const useDeepLinking = () => {
  const router = useRouter();

  useEffect(() => {
    const handleDeepLink = (url: string) => {
      const { pathname, queryParams } = Linking.parse(url);
      
      if (pathname === '/user') {
        router.push(`/user/${queryParams?.id}`);
      } else if (pathname === '/profile') {
        router.push('/profile');
      }
    };

    const subscription = Linking.addEventListener('url', ({ url }) => {
      handleDeepLink(url);
    });

    return () => subscription?.remove();
  }, [router]);
};
```

### 3. æ¨é€é€šçŸ¥

```typescript
// âœ… æ¨é€é€šçŸ¥
export const usePushNotifications = () => {
  const [expoPushToken, setExpoPushToken] = useState<string | null>(null);

  useEffect(() => {
    registerForPushNotificationsAsync().then(token => {
      setExpoPushToken(token);
    });
  }, []);

  useEffect(() => {
    const subscription = Notifications.addNotificationReceivedListener(notification => {
      console.log('Notification received:', notification);
    });

    return () => subscription.remove();
  }, []);

  return { expoPushToken };
};
```

## ğŸ“‹ ç§»åŠ¨ç«¯å¼€å‘æ£€æŸ¥æ¸…å•

å¼€å‘ç§»åŠ¨ç«¯åŠŸèƒ½æ—¶æ£€æŸ¥ï¼š

- [ ] å¹³å°é€‚é…ï¼ˆiOS/Androidï¼‰
- [ ] å“åº”å¼è®¾è®¡
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å†…å­˜ç®¡ç†
- [ ] é”™è¯¯å¤„ç†ï¼ˆä½¿ç”¨ Toastï¼Œç¦æ­¢ä½¿ç”¨ Alertï¼‰
- [ ] Toast é…ç½®ï¼ˆåœ¨æ ¹å¸ƒå±€ä¸­æ·»åŠ  `<Toast />`ï¼‰
- [ ] é¡µé¢å®½åº¦ç»Ÿä¸€ï¼ˆæ‰€æœ‰é¡µé¢ä½¿ç”¨ `PageContainer` ç»„ä»¶ï¼‰
- [ ] ç»Ÿä¸€æ ·å¼ç³»ç»Ÿï¼ˆä½¿ç”¨ `AppStyles` å’Œ `commonStyles`ï¼Œç¦æ­¢ç¡¬ç¼–ç æ ·å¼ï¼‰
- [ ] æ»šåŠ¨åŠŸèƒ½ï¼ˆç¡®ä¿ ScrollView åœ¨ Web å¹³å°å¯ä»¥æ­£å¸¸æ»šåŠ¨ï¼‰
- [ ] ç¦»çº¿æ”¯æŒ
- [ ] æ·±é“¾æ¥å¤„ç†
- [ ] æ¨é€é€šçŸ¥
- [ ] æ‰‹åŠ¿å¤„ç†
- [ ] ä¸»é¢˜åŒ–æ”¯æŒ

## ğŸ§ª ç§»åŠ¨ç«¯æµ‹è¯•

```typescript
// âœ… ç§»åŠ¨ç«¯æµ‹è¯•
describe('UserProfile', () => {
  it('should render user information correctly', () => {
    const user = { id: '1', name: 'John Doe', email: 'john@example.com' };
    render(<UserProfile user={user} />);
    
    expect(screen.getByText('John Doe')).toBeOnTheScreen();
    expect(screen.getByText('john@example.com')).toBeOnTheScreen();
  });

  it('should handle loading state', () => {
    render(<UserProfile userId="1" />);
    expect(screen.getByTestId('loading-spinner')).toBeOnTheScreen();
  });
});
```

## ğŸ“š ç›¸å…³èµ„æº

- [React Native æ–‡æ¡£](https://reactnative.dev/)
- [Expo æ–‡æ¡£](https://docs.expo.dev/)
- [Expo Router æ–‡æ¡£](https://expo.github.io/router/)
- [React Native æ€§èƒ½ä¼˜åŒ–](https://reactnative.dev/docs/performance)
- [ç§»åŠ¨ç«¯ç»„ä»¶åº“](mdc:Platform.App/components/)

### è·¯ç”±å®ˆå«å’Œè®¤è¯

```tsx
// âœ… æ­£ç¡®ï¼šè·¯ç”±å®ˆå«å®ç°
// app/_layout.tsx ä¸­ä½¿ç”¨
import { useEffect } from 'react';
import { useRouter, useSegments } from 'expo-router';
import { useAuth } from '@/contexts/AuthContext';

export function AuthGuard({ children }: { children: React.ReactNode }) {
  const { user, isLoading } = useAuth();
  const router = useRouter();
  const segments = useSegments();

  useEffect(() => {
    if (isLoading) return;

    const inAuthGroup = segments[0] === '(tabs)';

    if (!user && inAuthGroup) {
      router.replace('/login');
    } else if (user && !inAuthGroup) {
      router.replace('/(tabs)');
    }
  }, [user, isLoading, segments, router]);

  return <>{children}</>;
}

// âœ… æ­£ç¡®ï¼šé¡µé¢ä¸­è·¯ç”±è·³è½¬
import { useRouter } from 'expo-router';
import { useAuth } from '@/contexts/AuthContext';

export default function ProfileScreen() {
  const { user, logout } = useAuth();
  const router = useRouter();

  const handleLogout = async () => {
    await logout();
    router.replace('/login');
  };

  return (
    <View style={styles.container}>
      <Text style={styles.username}>{user?.username}</Text>
      <Text style={styles.email}>{user?.email}</Text>
      
      <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>
        <Text style={styles.logoutText}>é€€å‡ºç™»å½•</Text>
      </TouchableOpacity>
    </View>
  );
}
```

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

1. **å¹³å°é€‚é…** - è€ƒè™‘ iOS å’Œ Android å·®å¼‚
2. **æ€§èƒ½ä¼˜åŒ–** - ä½¿ç”¨ FlatListã€å›¾ç‰‡ä¼˜åŒ–ç­‰
3. **å“åº”å¼è®¾è®¡** - é€‚é…ä¸åŒå±å¹•å°ºå¯¸
4. **å†…å­˜ç®¡ç†** - æ¸…ç†å‰¯ä½œç”¨å’Œå®šæ—¶å™¨
5. **é”™è¯¯å¤„ç†** - é€‚å½“çš„é”™è¯¯è¾¹ç•Œå’Œé‡è¯•
6. **ç¦»çº¿æ”¯æŒ** - ç½‘ç»œçŠ¶æ€æ£€æµ‹å’Œæ•°æ®åŒæ­¥
7. **ç”¨æˆ·ä½“éªŒ** - æµç•…çš„åŠ¨ç”»å’Œäº¤äº’
8. **å¯è®¿é—®æ€§** - æ”¯æŒå±å¹•é˜…è¯»å™¨ç­‰è¾…åŠ©åŠŸèƒ½
