---
alwaysApply: true
description: OpenAPI + Scalar API æ–‡æ¡£è§„èŒƒ - ç§»é™¤å…¨éƒ¨ Swaggerï¼Œä½¿ç”¨ .NET 10 åŸç”Ÿ OpenAPI å’Œ Scalar
---

# OpenAPI + Scalar API æ–‡æ¡£è§„èŒƒ

## ğŸš« ç¦æ­¢ä½¿ç”¨ Swagger

**é¡¹ç›®å·²å®Œå…¨ç§»é™¤ Swagger/Swashbuckleï¼Œç»Ÿä¸€ä½¿ç”¨ .NET 10 åŸç”Ÿ OpenAPI + Scalar**

## âŒ ç¦æ­¢çš„åšæ³•

### 1. ä¸è¦æ·»åŠ  Swagger/Swashbuckle åŒ…

```xml
<!-- âŒ ç¦æ­¢ï¼šåœ¨ .csproj ä¸­æ·»åŠ  Swagger åŒ… -->
<ItemGroup>
  <PackageReference Include="Swashbuckle.AspNetCore" Version="6.5.0" />
  <PackageReference Include="Swashbuckle.AspNetCore.Annotations" Version="6.5.0" />
</ItemGroup>
```

### 2. ä¸è¦åœ¨ Program.cs ä¸­é…ç½® Swagger

```csharp
// âŒ ç¦æ­¢ï¼šä½¿ç”¨ Swagger é…ç½®
app.UseSwagger();
app.UseSwaggerUI(options =>
{
    options.SwaggerEndpoint("/swagger/v1/swagger.json", "My API V1");
    options.RoutePrefix = string.Empty;
});
```

### 3. ä¸è¦ä½¿ç”¨ Swagger ä¸­é—´ä»¶

```csharp
// âŒ ç¦æ­¢ï¼šä½¿ç”¨ SwaggerGen ä¸­é—´ä»¶
app.UseSwaggerGen();
```

### 4. ä¸è¦åœ¨æ–‡æ¡£ä¸­å¼•ç”¨ Swagger

```markdown
<!-- âŒ ç¦æ­¢ï¼šåœ¨æ–‡æ¡£ä¸­æ¨è Swagger -->
è¯·ä½¿ç”¨ Swagger Editor æŸ¥çœ‹ API æ–‡æ¡£ï¼šhttps://editor.swagger.io/
```

## âœ… æ­£ç¡®çš„åšæ³•

### 1. åœ¨é¡¹ç›®æ–‡ä»¶ä¸­å¯ç”¨ XML æ–‡æ¡£

```xml
<!-- âœ… æ­£ç¡®ï¼šåœ¨ .csproj ä¸­å¯ç”¨ XML æ–‡æ¡£ -->
<PropertyGroup>
  <TargetFramework>net10.0</TargetFramework>
  <ImplicitUsings>enable</ImplicitUsings>
  <Nullable>enable</Nullable>
  <GenerateDocumentationFile>true</GenerateDocumentationFile>
  <NoWarn>$(NoWarn);1591</NoWarn>
</PropertyGroup>
```

### 2. åœ¨ Program.cs ä¸­é…ç½® .NET 10 åŸç”Ÿ OpenAPI

```csharp
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ .NET 10 åŸç”Ÿ OpenAPI
builder.Services.AddOpenApi(options =>
{
    // æ–‡æ¡£è½¬æ¢å™¨ - é…ç½® API ä¿¡æ¯å’Œå®‰å…¨æ–¹æ¡ˆ
    options.AddDocumentTransformer((document, context, cancellationToken) =>
    {
        document.Info = new()
        {
            Title = "Platform API",
            Version = "v1",
            Description = "Aspire Admin Platform API - ä¼ä¸šçº§ç®¡ç†å¹³å°åç«¯æœåŠ¡",
            Contact = new()
            {
                Name = "Platform Team",
                Email = "support@platform.com"
            }
        };

        // æ·»åŠ  JWT è®¤è¯é…ç½®
        document.Components ??= new();
        document.Components.SecuritySchemes ??= new Dictionary<string, Microsoft.OpenApi.Models.OpenApiSecurityScheme>();
        document.Components.SecuritySchemes["Bearer"] = new()
        {
            Type = Microsoft.OpenApi.Models.SecuritySchemeType.Http,
            Scheme = "bearer",
            BearerFormat = "JWT",
            Description = "JWT Authorization header using the Bearer scheme."
        };

        // æ·»åŠ å…¨å±€å®‰å…¨è¦æ±‚
        document.SecurityRequirements ??= new List<Microsoft.OpenApi.Models.OpenApiSecurityRequirement>();
        document.SecurityRequirements.Add(new Microsoft.OpenApi.Models.OpenApiSecurityRequirement
        {
            [document.Components.SecuritySchemes["Bearer"]] = new string[0]
        });

        return Task.CompletedTask;
    });

    // æ“ä½œè½¬æ¢å™¨ - ä¸ºéœ€è¦è®¤è¯çš„ç«¯ç‚¹æ·»åŠ å®‰å…¨è¦æ±‚
    options.AddOperationTransformer((operation, context, cancellationToken) =>
    {
        var authorizeAttributes = context.Description.ActionDescriptor.EndpointMetadata
            .OfType<Microsoft.AspNetCore.Authorization.AuthorizeAttribute>();

        if (authorizeAttributes.Any())
        {
            operation.Security ??= new List<Microsoft.OpenApi.Models.OpenApiSecurityRequirement>();
            operation.Security.Add(new()
            {
                [new Microsoft.OpenApi.Models.OpenApiSecurityScheme
                {
                    Reference = new()
                    {
                        Type = Microsoft.OpenApi.Models.ReferenceType.SecurityScheme,
                        Id = "Bearer"
                    }
                }] = Array.Empty<string>()
            });
        }

        return Task.CompletedTask;
    });
});

// åœ¨ç®¡é“ä¸­æ˜ å°„ OpenAPI ç«¯ç‚¹
app.MapControllers();
app.MapOpenApi();  // âœ… ä½¿ç”¨ .NET 10 åŸç”Ÿ OpenAPI
app.MapDefaultEndpoints();
```

### 3. ä¸ºæ‰€æœ‰æ§åˆ¶å™¨å’Œæ–¹æ³•æ·»åŠ  XML æ³¨é‡Š

```csharp
/// <summary>
/// è·å–ç”¨æˆ·ä¿¡æ¯
/// </summary>
/// <param name="id">ç”¨æˆ·ID</param>
/// <returns>ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</returns>
/// <remarks>
/// ç¤ºä¾‹è¯·æ±‚ï¼š
/// GET /api/user/123
///
/// ç¤ºä¾‹å“åº”ï¼š
/// ```json
/// {
///   "id": "123",
///   "username": "admin",
///   "email": "admin@example.com"
/// }
/// ```
/// </remarks>
[HttpGet("{id}")]
public async Task<IActionResult> GetUser(string id)
{
    var user = await _userService.GetUserByIdAsync(id);
    if (user == null)
        throw new KeyNotFoundException($"ç”¨æˆ· {id} ä¸å­˜åœ¨");

    return Success(user);
}
```

### 4. ä¸º DTO ç±»æ·»åŠ  XML æ³¨é‡Š

```csharp
/// <summary>
/// ç”¨æˆ·æ³¨å†Œè¯·æ±‚å‚æ•°
/// </summary>
public class RegisterRequest
{
    /// <summary>
    /// ç”¨æˆ·åï¼ˆ3-50ä¸ªå­—ç¬¦ï¼Œæ”¯æŒå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰
    /// </summary>
    /// <example>admin</example>
    [Required]
    [StringLength(50, MinimumLength = 3)]
    public string Username { get; set; } = string.Empty;

    /// <summary>
    /// é‚®ç®±åœ°å€ï¼ˆå¿…é¡»æ˜¯æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼ï¼‰
    /// </summary>
    /// <example>admin@example.com</example>
    [Required]
    [EmailAddress]
    public string Email { get; set; } = string.Empty;

    /// <summary>
    /// å¯†ç ï¼ˆè‡³å°‘8ä½ï¼Œå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—ï¼‰
    /// </summary>
    /// <example>password123</example>
    [Required]
    [MinLength(8)]
    [RegularExpression(@"^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$",
        ErrorMessage = "å¯†ç è‡³å°‘8ä½ï¼Œå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—")]
    public string Password { get; set; } = string.Empty;
}
```

## ğŸ”§ è®¿é—®å’Œä½¿ç”¨ Scalar API æ–‡æ¡£

### 1. å¯åŠ¨é¡¹ç›®

```bash
dotnet run --project Platform.AppHost
```

### 2. æ‰“å¼€ Aspire Dashboard

è®¿é—®: **http://localhost:15003**ï¼ˆæœ¬åœ° `dotnet run`ï¼‰ / **http://localhost:18888**ï¼ˆ`aspire publish` + Docker Compose ä»ªè¡¨ç›˜ï¼‰

### 3. æŸ¥çœ‹ Scalar API æ–‡æ¡£

1. åœ¨ Aspire Dashboard ç‚¹å‡»é¡¶éƒ¨ **"Resources"** æ ‡ç­¾
2. åœ¨èµ„æºåˆ—è¡¨ä¸­æ‰¾åˆ° **"Scalar API Reference"** èµ„æº
3. ç‚¹å‡»è¯¥èµ„æºå³ä¾§çš„ **ç«¯ç‚¹é“¾æ¥å›¾æ ‡** ğŸ”—
4. Scalar API æ–‡æ¡£ä¼šåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€

### 4. ä½¿ç”¨ JWT è®¤è¯æµ‹è¯• API

#### è·å– Token
```bash
curl -X POST http://localhost:15000/apiservice/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }'
```

#### åœ¨ Scalar ä¸­é…ç½®è®¤è¯
1. åœ¨ Scalar æ–‡æ¡£é¡µé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **"Authorize"** æŒ‰é’®
2. è¾“å…¥ `Bearer <ä½ çš„token>`
3. ç‚¹å‡» **"Authorize"** ç¡®è®¤
4. ç°åœ¨æ‰€æœ‰éœ€è¦è®¤è¯çš„ API è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨å¸¦ä¸Šè¿™ä¸ª token

## ğŸ“Š Scalar åŠŸèƒ½ç‰¹æ€§

- âœ… æµè§ˆæ‰€æœ‰ API ç«¯ç‚¹ï¼ˆæŒ‰ Controller åˆ†ç»„ï¼‰
- âœ… æŸ¥çœ‹è¯·æ±‚/å“åº”çš„ Schema å®šä¹‰
- âœ… æŸ¥çœ‹å‚æ•°è¯´æ˜å’Œç¤ºä¾‹
- âœ… ç›´æ¥æµ‹è¯• API è°ƒç”¨ï¼ˆæ”¯æŒå‚æ•°å¡«å†™ï¼‰
- âœ… é…ç½® JWT è®¤è¯
- âœ… æ˜¾ç¤ºè®¤è¯çŠ¶æ€å’Œç”¨æˆ·ä¿¡æ¯
- âœ… æ”¯æŒå¤šç§è¯·æ±‚æ ¼å¼ï¼ˆJSONã€XMLã€Formï¼‰
- âœ… æ˜¾ç¤ºå“åº”æ—¶é—´å’ŒçŠ¶æ€ç 

## ğŸ” éªŒè¯æ–¹æ³•

### 1. æ£€æŸ¥ OpenAPI JSON ç«¯ç‚¹

è®¿é—®: **http://localhost:15000/apiservice/openapi/v1.json**

ç¡®è®¤ï¼š
- [ ] JSON æ ¼å¼æ­£ç¡®
- [ ] æ‰€æœ‰ API ç«¯ç‚¹éƒ½å­˜åœ¨
- [ ] è¯·æ±‚/å“åº” schema å®Œæ•´
- [ ] JWT Bearer å®‰å…¨æ–¹æ¡ˆå·²é…ç½®
- [ ] XML æ³¨é‡Šæ­£ç¡®æ˜¾ç¤º

### 2. åœ¨ Scalar ä¸­éªŒè¯

åœ¨ Scalar æ–‡æ¡£ç•Œé¢ï¼š
- [ ] å·¦ä¾§å¯¼èˆªæ æ˜¾ç¤ºæ‰€æœ‰ API ç«¯ç‚¹
- [ ] ç‚¹å‡»ä»»æ„ç«¯ç‚¹æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- [ ] è¯·æ±‚æ¨¡å‹å¯ä»¥å±•å¼€æŸ¥çœ‹
- [ ] å“åº”æ¨¡å‹æœ‰ç¤ºä¾‹æ•°æ®
- [ ] è®¤è¯å›¾æ ‡æ­£ç¡®æ˜¾ç¤ºï¼ˆğŸ”’ è¡¨ç¤ºéœ€è¦è®¤è¯ï¼‰

### 3. æµ‹è¯•è®¤è¯åŠŸèƒ½

1. æœªè®¤è¯çŠ¶æ€ï¼š
   - éœ€è¦è®¤è¯çš„ç«¯ç‚¹æ˜¾ç¤º ğŸ”’ å›¾æ ‡
   - ç‚¹å‡» "Try it out" æ—¶æç¤ºéœ€è¦è®¤è¯

2. è®¤è¯åï¼š
   - è®¤è¯æŒ‰é’®æ˜¾ç¤ºç»¿è‰²é”å›¾æ ‡
   - å¯ä»¥æ­£å¸¸è°ƒç”¨éœ€è¦è®¤è¯çš„ API
   - è¯·æ±‚å¤´ä¸­è‡ªåŠ¨åŒ…å« Authorization: Bearer token

## ğŸš« å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### âŒ é”™è¯¯ 1: INVALID_REFERENCE é”™è¯¯

**ç°è±¡**ï¼š
```
INVALID_REFERENCE: Can't resolve reference: #/components/schemas/LoginRequest
```

**åŸå› **ï¼š
- XML æ–‡æ¡£ç”Ÿæˆæœªå¯ç”¨
- ç¼ºå°‘ DocumentTransformer æˆ– OperationTransformer

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿é¡¹ç›®æ–‡ä»¶ä¸­å¯ç”¨ XML æ–‡æ¡£ï¼š
   ```xml
   <GenerateDocumentationFile>true</GenerateDocumentationFile>
   ```
2. ç¡®ä¿é…ç½®äº† DocumentTransformer å’Œ OperationTransformer
3. é‡å¯åº”ç”¨é‡æ–°ç”Ÿæˆæ–‡æ¡£

### âŒ é”™è¯¯ 2: æ— æ³•æŸ¥çœ‹è¯·æ±‚æ¨¡å‹

**ç°è±¡**ï¼š
- Scalar ä¸­è¯·æ±‚æ¨¡å‹æ˜¾ç¤ºä¸ºç©ºæˆ–é”™è¯¯

**åŸå› **ï¼š
- DTO ç±»ç¼ºå°‘ XML æ³¨é‡Š
- å‘½åç©ºé—´ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä¸ºæ‰€æœ‰ DTO ç±»æ·»åŠ å®Œæ•´çš„ XML æ³¨é‡Š
2. ç¡®ä¿ç±»åå’Œå‘½åç©ºé—´æ­£ç¡®
3. é‡å¯åº”ç”¨é‡æ–°ç”Ÿæˆæ–‡æ¡£

### âŒ é”™è¯¯ 3: JWT è®¤è¯ä¸å·¥ä½œ

**ç°è±¡**ï¼š
- Scalar ä¸­è®¤è¯æŒ‰é’®æ˜¾ç¤ºä½†æ— æ³•æ­£å¸¸å·¥ä½œ

**åŸå› **ï¼š
- JWT å®‰å…¨æ–¹æ¡ˆé…ç½®é”™è¯¯
- Token æ ¼å¼ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ DocumentTransformer ä¸­çš„ JWT é…ç½®
2. ç¡®ä¿ Token æ ¼å¼ä¸ºï¼š`Bearer <token>`ï¼ˆæ³¨æ„ç©ºæ ¼ï¼‰
3. æ£€æŸ¥åç«¯ JWT éªŒè¯é€»è¾‘

## ğŸ“‹ ä»£ç å®¡æŸ¥æ¸…å•

æ·»åŠ æˆ–ä¿®æ”¹ API ç«¯ç‚¹æ—¶ï¼Œæ£€æŸ¥ï¼š

### åç«¯æ£€æŸ¥
- [ ] åœ¨é¡¹ç›®æ–‡ä»¶ä¸­å¯ç”¨äº† `<GenerateDocumentationFile>true</GenerateDocumentationFile>`
- [ ] **ä¸ºæ–°çš„ Controller æ–¹æ³•æ·»åŠ äº†å®Œæ•´çš„ XML æ³¨é‡Š**ï¼ˆåŒ…æ‹¬ `<summary>`ã€`<param>`ã€`<returns>`ã€`<exception>`ï¼‰
- [ ] **ä¸ºæ–°çš„ DTO ç±»æ·»åŠ äº† XML æ³¨é‡Š**ï¼ˆåŒ…æ‹¬ç±»å’Œæ‰€æœ‰å±æ€§ï¼‰
- [ ] **ä¸ºæ–°çš„æœåŠ¡æ¥å£å’Œå®ç°æ·»åŠ äº† XML æ³¨é‡Š**ï¼ˆåŒ…æ‹¬æ‰€æœ‰æ–¹æ³•ï¼‰
- [ ] **ä¸ºæ–°çš„æ¨¡å‹ç±»æ·»åŠ äº† XML æ³¨é‡Š**ï¼ˆåŒ…æ‹¬æ‰€æœ‰å±æ€§ï¼‰
- [ ] **ç¼–è¯‘æ—¶æ²¡æœ‰ CS1591 è­¦å‘Š**
- [ ] å¦‚æœéœ€è¦è®¤è¯ï¼Œå·²æ·»åŠ  `[Authorize]` ç‰¹æ€§
- [ ] Program.cs ä¸­æœ‰æ­£ç¡®çš„ OpenAPI é…ç½®
- [ ] é‡å¯åº”ç”¨åæ–‡æ¡£èƒ½æ­£ç¡®æ˜¾ç¤º

### æ–‡æ¡£æ£€æŸ¥
- [ ] æ›´æ–°äº†ç›¸å…³çš„åŠŸèƒ½æ–‡æ¡£
- [ ] æ›´æ–°äº† API ä½¿ç”¨è¯´æ˜
- [ ] æ›´æ–°äº† Scalar ä½¿ç”¨æŒ‡å—
- [ ] æ›´æ–°äº†æ–‡æ¡£ç´¢å¼•

### æµ‹è¯•æ£€æŸ¥
- [ ] åœ¨ Scalar ä¸­èƒ½æ­£ç¡®æŸ¥çœ‹æ–°ç«¯ç‚¹çš„æ–‡æ¡£
- [ ] å¦‚æœéœ€è¦è®¤è¯ï¼Œèƒ½æ­£ç¡®æµ‹è¯•è®¤è¯åŠŸèƒ½
- [ ] è¯·æ±‚å’Œå“åº”ç¤ºä¾‹æ­£ç¡®æ˜¾ç¤º

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®ç»“æ„æŒ‡å—](mdc:.cursor/rules/project-structure.mdc) - åŒ…å« API æ–‡æ¡£è®¿é—®æ–¹å¼
- [.NET 10 OpenAPI å®˜æ–¹æ–‡æ¡£](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/openapi/overview)
- [Scalar å®˜æ–¹ç½‘ç«™](https://github.com/scalar/scalar)

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

1. **ç¦æ­¢ Swagger** - æ°¸ä¸ä½¿ç”¨ Swagger/Swashbuckle
2. **åŸç”Ÿ OpenAPI** - åªä½¿ç”¨ .NET 10 åŸç”Ÿ OpenAPI
3. **å®Œæ•´æ³¨é‡Šï¼ˆå¼ºåˆ¶è¦æ±‚ï¼‰** - æ‰€æœ‰ API å…ƒç´ éƒ½å¿…é¡»æœ‰ XML æ³¨é‡Šï¼Œè¿™æ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œä¸å…è®¸ä¾‹å¤–
4. **Scalar ä¼˜å…ˆ** - ä¸»è¦é€šè¿‡ Aspire Dashboard è®¿é—® Scalar
5. **åŠæ—¶æ›´æ–°** - ä»£ç å’Œæ–‡æ¡£åŒæ­¥æ›´æ–°
6. **å®Œæ•´æµ‹è¯•** - ç¡®ä¿ Scalar ä¸­æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

**âœ… é¡¹ç›®å·²å®ç°**ï¼š
- æ‰€æœ‰ C# ä»£ç æ–‡ä»¶ï¼ˆ1082+ ä¸ªå…¬å…±æˆå‘˜ï¼‰å·²æ·»åŠ å®Œæ•´çš„ XML æ–‡æ¡£æ³¨é‡Š
- ç¼–è¯‘æ—¶æ—  CS1591 è­¦å‘Š
- Scalar API æ–‡æ¡£å¯ä»¥æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æ¥å£è¯´æ˜å’Œå‚æ•°æè¿°
- æå‡äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§

## ğŸš¨ XML æ³¨é‡Šå¼ºåˆ¶è¦æ±‚

**æ‰€æœ‰å…¬å…±ç±»å‹å’Œæˆå‘˜å¿…é¡»åŒ…å«å®Œæ•´çš„ XML æ–‡æ¡£æ³¨é‡Šï¼Œè¿™æ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œä¸å…è®¸ä¾‹å¤–ã€‚**

**âš ï¸ é‡è¦æç¤º**ï¼šXML æ–‡æ¡£æ³¨é‡Šæ˜¯ .NET 10 OpenAPI + Scalar API æ–‡æ¡£ç”Ÿæˆçš„åŸºç¡€ï¼Œç¼ºå¤±æ³¨é‡Šä¼šå¯¼è‡´ï¼š
- Scalar API æ–‡æ¡£ä¸­ç¼ºå°‘æ¥å£è¯´æ˜å’Œå‚æ•°æè¿°
- æ— æ³•æ­£ç¡®ç”Ÿæˆ OpenAPI Schema å’Œç¤ºä¾‹
- é™ä½ API æ–‡æ¡£çš„å¯è¯»æ€§å’Œå¯ç”¨æ€§
- è¿åé¡¹ç›®ä»£ç è´¨é‡æ ‡å‡†

**âœ… é¡¹ç›®å·²å®ç°**ï¼šæ‰€æœ‰ C# ä»£ç æ–‡ä»¶ï¼ˆ1082+ ä¸ªå…¬å…±æˆå‘˜ï¼‰å·²æ·»åŠ å®Œæ•´çš„ XML æ–‡æ¡£æ³¨é‡Šï¼Œç¼–è¯‘æ—¶æ—  CS1591 è­¦å‘Šã€‚

### å¿…é¡»æ·»åŠ æ³¨é‡Šçš„å…ƒç´ 

ä»¥ä¸‹æ‰€æœ‰å…¬å…±å…ƒç´ **å¿…é¡»**åŒ…å« XML æ³¨é‡Šï¼š

- âœ… **æ‰€æœ‰å…¬å…±ç±»ï¼ˆpublic classï¼‰** - åŒ…æ‹¬æœåŠ¡ç±»ã€æ§åˆ¶å™¨ç±»ã€æ¨¡å‹ç±»ç­‰
- âœ… **æ‰€æœ‰å…¬å…±æ¥å£ï¼ˆpublic interfaceï¼‰** - åŒ…æ‹¬æœåŠ¡æ¥å£ã€æ•°æ®è®¿é—®æ¥å£ç­‰
- âœ… **æ‰€æœ‰å…¬å…±æšä¸¾ï¼ˆpublic enumï¼‰** - åŒ…æ‹¬æ¯ä¸ªæšä¸¾å€¼ä¹Ÿéœ€è¦æ³¨é‡Š
- âœ… **æ‰€æœ‰æ§åˆ¶å™¨æ–¹æ³•ï¼ˆController actionsï¼‰** - åŒ…æ‹¬ HTTP æ–¹æ³•å’Œå‚æ•°
- âœ… **æ‰€æœ‰æœåŠ¡æ–¹æ³•ï¼ˆService methodsï¼‰** - åŒ…æ‹¬æ¥å£å’Œå®ç°ç±»çš„æ–¹æ³•
- âœ… **æ‰€æœ‰è¯·æ±‚/å“åº”æ¨¡å‹ï¼ˆRequest/Response modelsï¼‰** - åŒ…æ‹¬æ‰€æœ‰ DTO ç±»
- âœ… **æ‰€æœ‰ DTO å±æ€§ï¼ˆDTO propertiesï¼‰** - åŒ…æ‹¬è¯·æ±‚å’Œå“åº”æ¨¡å‹çš„å±æ€§
- âœ… **æ‰€æœ‰æ„é€ å‡½æ•°ï¼ˆConstructorsï¼‰** - åŒ…æ‹¬æ‰€æœ‰å‚æ•°è¯´æ˜
- âœ… **æ‰€æœ‰ä¸­é—´ä»¶ç±»å’Œæ–¹æ³•** - åŒ…æ‹¬æ„é€ å‡½æ•°å’Œ InvokeAsync æ–¹æ³•
- âœ… **æ‰€æœ‰å¸¸é‡ï¼ˆConstantsï¼‰** - åŒ…æ‹¬é”™è¯¯æ¶ˆæ¯å¸¸é‡ç­‰

### æ³¨é‡Šè´¨é‡è¦æ±‚

XML æ³¨é‡Šå¿…é¡»æ»¡è¶³ä»¥ä¸‹è´¨é‡è¦æ±‚ï¼š

- âœ… **ä½¿ç”¨ `<summary>`** - æè¿°ç±»ã€æ–¹æ³•ã€å±æ€§çš„åŠŸèƒ½å’Œç”¨é€”
- âœ… **ä½¿ç”¨ `<param>`** - æè¿°æ‰€æœ‰æ–¹æ³•å‚æ•°ï¼ŒåŒ…æ‹¬å‚æ•°ç±»å‹å’Œç”¨é€”
- âœ… **ä½¿ç”¨ `<returns>`** - æè¿°è¿”å›å€¼ï¼ŒåŒ…æ‹¬è¿”å›ç±»å‹å’Œå¯èƒ½çš„å€¼
- âœ… **ä½¿ç”¨ `<exception>`** - æè¿°å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹å’Œè§¦å‘æ¡ä»¶
- âœ… **ä½¿ç”¨ `<remarks>`** - æä¾›ä½¿ç”¨ç¤ºä¾‹ã€æ³¨æ„äº‹é¡¹ç­‰é¢å¤–ä¿¡æ¯ï¼ˆå¦‚é€‚ç”¨ï¼‰
- âœ… **ä½¿ç”¨ `<example>`** - æä¾›ç¤ºä¾‹å€¼ï¼ˆå¦‚é€‚ç”¨ï¼Œç‰¹åˆ«æ˜¯ DTO å±æ€§ï¼‰
- âœ… **ä½¿ç”¨ `<typeparam>`** - æè¿°æ³›å‹ç±»å‹å‚æ•°ï¼ˆå¦‚é€‚ç”¨ï¼‰

### æ³¨é‡Šç¤ºä¾‹

#### æ§åˆ¶å™¨æ–¹æ³•æ³¨é‡Š

```csharp
/// <summary>
/// è·å–ç”¨æˆ·ä¿¡æ¯
/// </summary>
/// <param name="id">ç”¨æˆ·IDï¼ˆMongoDB ObjectIdï¼‰</param>
/// <returns>ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</returns>
/// <remarks>
/// ç¤ºä¾‹è¯·æ±‚ï¼š
/// GET /api/user/123
///
/// ç¤ºä¾‹å“åº”ï¼š
/// ```json
/// {
///   "id": "123",
///   "username": "admin",
///   "email": "admin@example.com"
/// }
/// ```
/// </remarks>
/// <exception cref="KeyNotFoundException">å½“ç”¨æˆ·ä¸å­˜åœ¨æ—¶æŠ›å‡º</exception>
[HttpGet("{id}")]
public async Task<IActionResult> GetUser(string id)
{
    var user = await _userService.GetUserByIdAsync(id);
    if (user == null)
        throw new KeyNotFoundException($"ç”¨æˆ· {id} ä¸å­˜åœ¨");
    
    return Success(user);
}
```

#### æœåŠ¡æ¥å£å’Œå®ç°æ³¨é‡Š

```csharp
/// <summary>
/// ç”¨æˆ·æœåŠ¡æ¥å£
/// </summary>
public interface IUserService
{
    /// <summary>
    /// æ ¹æ®IDè·å–ç”¨æˆ·ï¼ˆå¸¦ç§Ÿæˆ·è¿‡æ»¤ï¼‰
    /// </summary>
    /// <param name="id">ç”¨æˆ·ID</param>
    /// <returns>ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› null</returns>
    Task<User?> GetUserByIdAsync(string id);
}

/// <summary>
/// ç”¨æˆ·æœåŠ¡å®ç°
/// </summary>
public class UserService : IUserService
{
    private readonly IDatabaseOperationFactory<User> _userFactory;

    /// <summary>
    /// åˆå§‹åŒ–ç”¨æˆ·æœåŠ¡
    /// </summary>
    /// <param name="userFactory">ç”¨æˆ·æ•°æ®æ“ä½œå·¥å‚</param>
    public UserService(IDatabaseOperationFactory<User> userFactory)
    {
        _userFactory = userFactory;
    }
    
    /// <summary>
    /// æ ¹æ®IDè·å–ç”¨æˆ·ï¼ˆå¸¦ç§Ÿæˆ·è¿‡æ»¤ï¼‰
    /// </summary>
    /// <param name="id">ç”¨æˆ·ID</param>
    /// <returns>ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› null</returns>
    public async Task<User?> GetUserByIdAsync(string id)
    {
        return await _userFactory.GetByIdAsync(id);
    }
}
```

#### DTO æ¨¡å‹æ³¨é‡Š

```csharp
/// <summary>
/// åˆ›å»ºç”¨æˆ·è¯·æ±‚
/// </summary>
public class CreateUserRequest
{
    /// <summary>
    /// ç”¨æˆ·åï¼ˆ3-50ä¸ªå­—ç¬¦ï¼Œæ”¯æŒå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰
    /// </summary>
    /// <example>admin</example>
    [Required(ErrorMessage = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")]
    [StringLength(50, MinimumLength = 3)]
    public string Username { get; set; } = string.Empty;
    
    /// <summary>
    /// é‚®ç®±åœ°å€ï¼ˆå¿…é¡»æ˜¯æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼ï¼‰
    /// </summary>
    /// <example>admin@example.com</example>
    [Required(ErrorMessage = "é‚®ç®±ä¸èƒ½ä¸ºç©º")]
    [EmailAddress]
    public string Email { get; set; } = string.Empty;
}
```

### éªŒè¯æ–¹æ³•

ç¼–è¯‘é¡¹ç›®æ—¶ä¸åº”è¯¥æœ‰ä»»ä½• XML æ³¨é‡Šè­¦å‘Šï¼š

```bash
# ç¼–è¯‘é¡¹ç›®
dotnet build

# æ£€æŸ¥æ˜¯å¦æœ‰ XML æ³¨é‡Šè­¦å‘Š
dotnet build 2>&1 | grep "CS1591"

# åº”è¯¥æ²¡æœ‰è¾“å‡ºï¼ˆ0 ä¸ªè­¦å‘Šï¼‰
```

**âœ… é¡¹ç›®çŠ¶æ€**ï¼šå½“å‰é¡¹ç›®å·²ä¿®å¤æ‰€æœ‰ CS1591 è­¦å‘Šï¼Œæ‰€æœ‰å…¬å…±ç±»å‹å’Œæˆå‘˜éƒ½æœ‰å®Œæ•´çš„ XML æ–‡æ¡£æ³¨é‡Šã€‚

## âš¡ å¿«é€ŸéªŒè¯å‘½ä»¤

```bash
# 1. æ£€æŸ¥ OpenAPI JSON æ ¼å¼
curl http://localhost:15000/apiservice/openapi/v1.json | jq '.info'

# 2. æ£€æŸ¥ç«¯ç‚¹æ•°é‡
curl http://localhost:15000/apiservice/openapi/v1.json | jq '.paths | length'

# 3. æ£€æŸ¥ JWT å®‰å…¨æ–¹æ¡ˆ
curl http://localhost:15000/apiservice/openapi/v1.json | jq '.components.securitySchemes'

# 4. æµ‹è¯•è®¤è¯
curl -H "Authorization: Bearer <your-token>" http://localhost:15000/apiservice/api/auth/current-user
```

## ğŸ¯ è®°ä½

**ç§»é™¤ Swaggerï¼Œæ‹¥æŠ± OpenAPI + Scalar** - è¿™æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ã€ä¸ .NET Aspire å®Œç¾é›†æˆçš„ API æ–‡æ¡£è§£å†³æ–¹æ¡ˆã€‚
