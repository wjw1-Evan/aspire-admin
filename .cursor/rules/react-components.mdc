---
globs: *.tsx,*.jsx,Platform.Admin/src/components/*.tsx,Platform.App/components/*.tsx
description: React ç»„ä»¶å¼€å‘è§„èŒƒå’Œè®¾è®¡æ¨¡å¼ - ç»„ä»¶è®¾è®¡ã€Propsã€æ ·å¼ã€çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ
---

# React ç»„ä»¶å¼€å‘è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

**éµå¾ª React ç»„ä»¶è®¾è®¡åŸåˆ™ï¼Œä½¿ç”¨ç±»å‹å®‰å…¨çš„ Propsï¼Œéµå¾ªå•ä¸€èŒè´£å’Œå¯å¤ç”¨æ€§**

## ğŸ—ï¸ ç»„ä»¶æ¶æ„æ¨¡å¼

### ç»„ä»¶åˆ†å±‚æ¶æ„

```typescript
// âœ… ç»„ä»¶åˆ†å±‚æ¶æ„
// 1. é¡µé¢ç»„ä»¶ (Pages) - ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†
// 2. å®¹å™¨ç»„ä»¶ (Containers) - æ•°æ®è·å–å’ŒçŠ¶æ€ç®¡ç†
// 3. å±•ç¤ºç»„ä»¶ (Presentational) - çº¯å±•ç¤ºé€»è¾‘
// 4. åŸºç¡€ç»„ä»¶ (Base) - å¯å¤ç”¨çš„åŸºç¡€ç»„ä»¶
// 5. å¸ƒå±€ç»„ä»¶ (Layout) - é¡µé¢å¸ƒå±€ç»“æ„
```

## ğŸ¯ ç»„ä»¶è®¾è®¡åŸåˆ™

### ç»„ä»¶ç»“æ„
```typescript
// âœ… æ¨èï¼šæ ‡å‡†çš„ç»„ä»¶ç»“æ„
import React from 'react';
import { Button, Card } from 'antd';
import type { UserCardProps } from './types';

export default function UserCard({ user, onEdit }: UserCardProps) {
  // 1. Hooks
  const [loading, setLoading] = useState(false);
  
  // 2. äº‹ä»¶å¤„ç†å‡½æ•°
  const handleEdit = useCallback(() => {
    onEdit?.(user);
  }, [user, onEdit]);
  
  // 3. æ¸²æŸ“é€»è¾‘
  return (
    <Card>
      <h3>{user.name}</h3>
      <Button onClick={handleEdit}>ç¼–è¾‘</Button>
    </Card>
  );
}
```

### Props è®¾è®¡

```typescript
// âœ… æ¨èï¼šæ˜ç¡®çš„ Props æ¥å£
interface UserCardProps {
  readonly user: User;
  readonly onEdit?: (user: User) => void;
  readonly onDelete?: (userId: string) => void;
  readonly loading?: boolean;
  readonly className?: string;
}

// âœ… å•ä¸€èŒè´£åŸåˆ™
interface UserCardProps {
  user: User;
  onEdit: (user: User) => void;
  onDelete: (userId: string) => void;
}

// åªè´Ÿè´£ç”¨æˆ·ä¿¡æ¯çš„å±•ç¤ºå’ŒåŸºæœ¬æ“ä½œ
export const UserCard: React.FC<UserCardProps> = ({ user, onEdit, onDelete }) => {
  return (
    <Card>
      <CardHeader>
        <Avatar src={user.avatar} />
        <Typography>{user.name}</Typography>
      </CardHeader>
      <CardActions>
        <Button onClick={() => onEdit(user)}>ç¼–è¾‘</Button>
        <Button onClick={() => onDelete(user.id)}>åˆ é™¤</Button>
      </CardActions>
    </Card>
  );
};
```

## ğŸ¯ ç»„ä»¶è®¾è®¡æ¨¡å¼

### 1. é«˜é˜¶ç»„ä»¶ (HOC) æ¨¡å¼

```typescript
// âœ… é«˜é˜¶ç»„ä»¶æ¨¡å¼
interface WithLoadingProps {
  loading: boolean;
}

export function withLoading<P extends object>(
  Component: React.ComponentType<P>
): React.ComponentType<P & WithLoadingProps> {
  return function WithLoadingComponent(props: P & WithLoadingProps) {
    const { loading, ...restProps } = props;
    
    if (loading) {
      return <LoadingSpinner />;
    }
    
    return <Component {...(restProps as P)} />;
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const UserListWithLoading = withLoading(UserList);
```

### 2. æ¸²æŸ“å±æ€§ (Render Props) æ¨¡å¼

```typescript
// âœ… æ¸²æŸ“å±æ€§æ¨¡å¼
interface DataFetcherProps<T> {
  url: string;
  children: (data: {
    data: T | null;
    loading: boolean;
    error: string | null;
    refetch: () => void;
  }) => React.ReactNode;
}

export function DataFetcher<T>({ url, children }: DataFetcherProps<T>) {
  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetch = useCallback(async () => {
    setLoading(true);
    setError(null);
    try {
      const result = await fetch(url).then(r => r.json());
      setData(result);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'è·å–æ•°æ®å¤±è´¥');
    } finally {
      setLoading(false);
    }
  }, [url]);

  useEffect(() => {
    fetch();
  }, [fetch]);

  return <>{children({ data, loading, error, refetch: fetch })}</>;
}
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### ä¸»é¢˜åŒ–ç»„ä»¶
åœ¨ç§»åŠ¨ç«¯åº”ç”¨ä¸­ä½¿ç”¨ä¸»é¢˜åŒ–ç»„ä»¶ï¼š

```typescript
// âœ… æ¨èï¼šä½¿ç”¨ä¸»é¢˜åŒ–ç»„ä»¶
import { ThemedText, ThemedView, ThemedButton } from '@/components';

export default function ProfileScreen() {
  const backgroundColor = useThemeColor({}, 'background');
  
  return (
    <ThemedView style={{ backgroundColor }}>
      <ThemedText type="title">ä¸ªäººä¸­å¿ƒ</ThemedText>
      <ThemedButton title="ç¼–è¾‘èµ„æ–™" />
    </ThemedView>
  );
}
```

### æ ·å¼ç»„ç»‡
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ StyleSheet
const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 16,
  },
  title: {
    fontSize: 18,
    fontWeight: 'bold',
    marginBottom: 16,
  },
});
```

## ğŸ”„ çŠ¶æ€ç®¡ç†

### æœ¬åœ°çŠ¶æ€
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ useState å’Œ useCallback
function UserForm() {
  const [formData, setFormData] = useState<UserFormData>({
    name: '',
    email: '',
  });
  
  const handleSubmit = useCallback(async () => {
    try {
      await submitUser(formData);
      message.success('ä¿å­˜æˆåŠŸ');
    } catch (error) {
      message.error('ä¿å­˜å¤±è´¥');
    }
  }, [formData]);
}
```

### å…¨å±€çŠ¶æ€
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ Context è¿›è¡Œä¸»é¢˜ç®¡ç†
const { themeMode, setThemeMode, isDark } = useTheme();
```

## ğŸ“± ç§»åŠ¨ç«¯ç‰¹å®šè§„èŒƒ

### å¯¼èˆª
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ Expo Router
import { router } from 'expo-router';

const navigateToProfile = () => {
  router.push('/profile');
};
```

### å¹³å°é€‚é…
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ Platform è¿›è¡Œå¹³å°é€‚é…
import { Platform } from 'react-native';

const styles = StyleSheet.create({
  container: {
    paddingTop: Platform.OS === 'ios' ? 44 : 24,
  },
});
```

## ğŸš« é¿å…çš„åšæ³•

- ä¸è¦ç›´æ¥ä¿®æ”¹ props
- ä¸è¦ä½¿ç”¨ `componentWillMount` ç­‰å·²åºŸå¼ƒçš„ç”Ÿå‘½å‘¨æœŸ
- ä¸è¦å¿˜è®°æ·»åŠ  `key` å±æ€§åˆ°åˆ—è¡¨é¡¹
- ä¸è¦åœ¨å†…è”å‡½æ•°ä¸­åˆ›å»ºå¯¹è±¡æˆ–æ•°ç»„
- ä¸è¦å¿˜è®°æ¸…ç†å‰¯ä½œç”¨ï¼ˆuseEffect çš„æ¸…ç†å‡½æ•°ï¼‰

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### è®°å¿†åŒ–
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ useMemo å’Œ useCallback
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]);

const handleClick = useCallback(() => {
  onItemClick(item.id);
}, [item.id, onItemClick]);
```

### æ‡’åŠ è½½
```typescript
// âœ… æ¨èï¼šä½¿ç”¨ React.lazy è¿›è¡Œä»£ç åˆ†å‰²
const UserManagement = lazy(() => import('./UserManagement'));
```
