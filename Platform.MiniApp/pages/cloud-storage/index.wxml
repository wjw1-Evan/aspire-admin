<view class="container">
  <!-- Breadcrumb / Header Navigation -->
  <view class="nav-header card-style">
    <view class="breadcrumb">
      <view class="bread-item {{pathStack.length === 0 ? 'active' : ''}}" bindtap="navToRoot">{{t['cloud.all_files']}}</view>
      <block wx:for="{{pathStack}}" wx:key="id">
        <text class="separator">/</text>
        <view class="bread-item {{index === pathStack.length - 1 ? 'active' : ''}}" bindtap="navToFolder" data-index="{{index}}">{{item.name}}</view>
      </block>
    </view>
  </view>

  <loading wx:if="{{loading && !isRefreshing}}" />

  <!-- File List -->
  <scroll-view scroll-y class="file-list-scroll">
    <view class="file-list" wx:if="{{fileList.length > 0}}">
      <view 
        class="file-item" 
        wx:for="{{fileList}}" 
        wx:key="id" 
        bindtap="onItemClick" 
        bindlongpress="showActionMenu"
        data-item="{{item}}"
      >
        <view class="file-icon {{item.type === 1 ? 'folder' : 'file'}}">
           <text wx:if="{{item.type === 1}}" class="iconfont icon-folder"></text>
           <text wx:else class="iconfont {{item.icon || 'icon-file'}}"></text>
        </view>
        <view class="file-info">
          <text class="file-name">{{item.name}}</text>
          <view class="file-meta">
            <text class="file-date">{{item.displayTime}}</text>
            <text class="file-size" wx:if="{{item.type === 0}}">{{item.displaySize}}</text>
          </view>
        </view>
        <view class="file-action" catchtap="showActionMenu" data-item="{{item}}">
          <text class="iconfont icon-more"></text>
        </view>
      </view>
    </view>

    <!-- Empty State -->
    <view class="empty-state" wx:elif="{{!loading}}">
      <view class="empty-icon">
        <text class="iconfont icon-folder"></text>
      </view>
      <text>{{t['cloud.empty_folder']}}</text>
    </view>
  </scroll-view>

  <!-- Floating Action Buttons -->
  <view class="fab-group">
    <view class="fab-btn main-fab" bindtap="toggleFab">
      <text class="iconfont icon-plus fab-icon {{showFabMenu ? 'rotate' : ''}}"></text>
    </view>
    
    <view class="fab-menu {{showFabMenu ? 'show' : ''}}">
      <view class="fab-item" bindtap="uploadImage">
        <view class="fab-item-icon bg-blue">
          <text class="iconfont icon-file-image"></text>
        </view>
        <text class="fab-item-text">{{t['cloud.upload_image']}}</text>
      </view>
      <view class="fab-item" bindtap="uploadFile">
        <view class="fab-item-icon bg-orange">
          <text class="iconfont icon-file"></text>
        </view>
        <text class="fab-item-text">{{t['cloud.wechat_file']}}</text>
      </view>
      <view class="fab-item" bindtap="showCreateFolder">
        <view class="fab-item-icon bg-green">
          <text class="iconfont icon-folder"></text>
        </view>
        <text class="fab-item-text">{{t['cloud.new_folder']}}</text>
      </view>
    </view>
  </view>

  <!-- Create Folder Dialog -->
  <view class="modal-mask" wx:if="{{showFolderModal}}" bindtap="closeFolderModal">
    <view class="modal-content" catchtap="prevent">
      <view class="modal-header">{{t['cloud.new_folder_title']}}</view>
      <input 
        class="modal-input" 
        placeholder="{{t['cloud.folder_placeholder']}}" 
        focus="{{showFolderModal}}"
        bindinput="onFolderNameInput"
        value="{{newFolderName}}"
      />
      <view class="modal-footer">
        <button class="btn-cancel" bindtap="closeFolderModal">{{t['common.cancel']}}</button>
        <button class="btn-confirm" bindtap="confirmCreateFolder">{{t['common.confirm']}}</button>
      </view>
    </view>
  </view>
</view>
