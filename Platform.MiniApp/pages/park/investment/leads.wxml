<view class="container">
  <view class="search-bar">
    <view class="search-box">
      <icon class="search-icon" type="search" size="14"></icon>
      <input class="search-input" placeholder="{{t['searchPlaceholder']}}" bindinput="onSearchInput" value="{{searchKeyword}}" bindconfirm="handleSearch" />
    </view>
    <view class="search-btn" bindtap="handleSearch">{{t['search']}}</view>
  </view>

  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'lead' ? 'active' : ''}}" bindtap="switchTab" data-tab="lead">
      {{t['tabLead']}}
    </view>
    <view class="tab-item {{activeTab === 'project' ? 'active' : ''}}" bindtap="switchTab" data-tab="project">
      {{t['tabProject']}}
    </view>
  </view>

  <view class="filter-bar">
    <scroll-view class="filter-tabs" scroll-x="true" enable-flex>
      <view wx:for="{{statusOptions}}" wx:key="value" 
            class="filter-tab {{currentStatus === item.value ? 'active' : ''}}" 
            bindtap="switchStatus" data-status="{{item.value}}">
        {{item.label}}
      </view>
    </scroll-view>
  </view>

  <view class="list-container">
    <!-- Leads List -->
    <block wx:if="{{activeTab === 'lead'}}">
      <view wx:for="{{leads}}" wx:key="id" class="biz-card" bindtap="goToDetail" data-id="{{item.id}}">
        <view class="section-header">
          <text class="section-title">{{item.companyName}}</text>
          <view class="status-tag status-{{item.status}}">{{statusMap[item.status]}}</view>
        </view>
        <view class="card-body">
          <view class="info-row">
            <text class="label">{{t['contactPerson']}}</text>
            <text class="value">{{item.contactPerson || '-'}}</text>
          </view>
          <view class="info-row">
            <text class="label">{{t['industry']}}</text>
            <text class="value">{{item.industry || '-'}}</text>
          </view>
          <view class="info-row">
            <text class="label">{{t['intendedArea']}}</text>
            <text class="value">{{item.intendedArea ? item.intendedArea + '㎡' : '-'}}</text>
          </view>
        </view>
        <view class="card-footer">
          <text class="date">{{t['createdAt']}}: {{item.createdAt}}</text>
          <text class="priority-tag priority-{{item.priority}}">{{priorityMap[item.priority]}}</text>
        </view>
      </view>
    </block>

    <!-- Projects List -->
    <block wx:if="{{activeTab === 'project'}}">
      <view wx:for="{{projects}}" wx:key="id" class="biz-card" bindtap="goToProjectDetail" data-id="{{item.id}}">
        <view class="section-header">
          <text class="section-title">{{item.name}}</text>
          <view class="status-tag status-{{item.status}}">{{statusMap[item.status] || item.status}}</view>
        </view>
        <view class="card-body">
          <view class="info-row">
            <text class="label">ID</text>
            <text class="value">{{item.leadId}}</text>
          </view>
          <view class="info-row">
            <text class="label">{{t['requirements']}}</text>
            <text class="value">{{item.requirements || '-'}}</text>
          </view>
        </view>
      </view>
    </block>
    
    <!-- Loading State -->
    <view class="loading-wrap" wx:if="{{loading}}">
      <view class="loading"></view>
      <text>{{t['loading']}}</text>
    </view>

    <!-- No More Data -->
    <view class="no-more" wx:if="{{!hasMore && (activeTab === 'lead' ? leads.length : projects.length) > 0}}">
      {{t['noMore'] || '没有更多了'}}
    </view>

    <!-- Empty State -->
    <view class="empty-wrap" wx:if="{{!loading && (activeTab === 'lead' ? leads.length === 0 : projects.length === 0)}}">
      <view class="iconfont icon-empty" style="font-size: 120rpx; color: #eee;"></view>
      <text>{{t['empty']}}</text>
    </view>
  </view>

  <!-- Add Button -->
  <view class="add-btn" bindtap="goToAdd">
    <text class="iconfont icon-plus"></text>
  </view>
</view>
