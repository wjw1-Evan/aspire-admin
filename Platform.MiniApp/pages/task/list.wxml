<view class="container">
  <!-- Statistics Section -->
  <view class="stats-overview card-style" wx:if="{{statistics}}">
    <view class="stats-item">
      <text class="num">{{statistics.totalTasks || 0}}</text>
      <text class="label">{{t['task.list.total']}}</text>
    </view>
    <view class="stats-item">
      <text class="num primary">{{statistics.inProgressTasks || 0}}</text>
      <text class="label">{{t['task.list.in_progress']}}</text>
    </view>
    <view class="stats-item">
      <text class="num success">{{statistics.completedTasks || 0}}</text>
      <text class="label">{{t['task.list.completed']}}</text>
    </view>
    <view class="stats-item">
      <text class="num danger">{{statistics.completionRate || 0}}%</text>
      <text class="label">{{t['task.list.completion_rate']}}</text>
    </view>
  </view>

  <!-- Filter Tabs -->
  <scroll-view class="filter-tabs" scroll-x enable-flex>
    <view 
      class="tab-item {{currentStatus === item.value ? 'active' : ''}}" 
      wx:for="{{statusTabs}}" 
      wx:key="value"
      bindtap="switchTab"
      data-status="{{item.value}}"
    >
      {{item.label}}
    </view>
  </scroll-view>

  <!-- Task List -->
  <view class="task-list">
    <block wx:if="{{tasks.length > 0}}">
      <view 
        class="task-card card-style" 
        wx:for="{{tasks}}" 
        wx:key="id"
        bindtap="goToDetail"
        data-id="{{item.id}}"
      >
        <view class="task-header">
          <view class="title-area">
            <text class="task-name">{{item.taskName}}</text>
            <text class="project-tag" wx:if="{{item.projectName}}">{{item.projectName}}</text>
          </view>
          <view class="priority-tag priority-{{item.priority}}">{{priorityMap[item.priority]}}</view>
        </view>

        <view class="task-info">
          <view class="info-row">
            <text class="label">{{t['task.list.assignee']}}</text>
            <text class="value">{{item.assignedToName || t['task.list.unassigned']}}</text>
          </view>
          <view class="info-row">
            <text class="label">{{t['task.list.deadline']}}</text>
            <text class="value">{{item.plannedEndTime || '-'}}</text>
          </view>
        </view>

        <view class="progress-bar-wrap">
          <view class="progress-text">
            <text class="status-text {{'status-' + item.status}}">{{statusMap[item.status]}}</text>
            <text class="percent">{{item.completionPercentage}}%</text>
          </view>
          <progress 
            percent="{{item.completionPercentage}}" 
            stroke-width="4" 
            color="#1890ff" 
            border-radius="2"
          />
        </view>
      </view>
    </block>

    <!-- Empty State -->
    <view class="empty-state" wx:else>
      <image src="/assets/logo.png" mode="aspectFit" class="empty-icon"></image>
      <text class="empty-text">{{t['task.list.no_data']}}</text>
    </view>

    <!-- Loading -->
    <view class="loading-bar" wx:if="{{loading}}">{{t['task.list.loading_more']}}</view>
    <view class="no-more" wx:if="{{!hasMore && tasks.length > 0}}">{{t['task.list.no_more']}}</view>
  </view>

  <!-- Floating Action Button -->
  <view class="fab-btn" bindtap="goToCreate">
    <text class="iconfont icon-plus"></text>
  </view>
</view>
