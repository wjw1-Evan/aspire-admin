const zhCN = {
    // Common
    'common.confirm': '确定',
    'common.cancel': '取消',
    'common.tips': '提示',
    'common.loading': '加载中...',
    'common.success': '操作成功',
    'common.fail': '操作失败',
    'common.empty': '暂无数据',
    'common.search': '搜索',
    'common.save': '保存',
    'common.delete': '删除',
    'common.edit': '编辑',
    'common.create': '创建',
    'common.detail': '详情',
    'common.all': '全部',
    'common.uploading': '上传中...',
    'common.downloading': '下载中...',
    'common.processing': '处理中...',
    'common.required': '必填',
    'common.optional': '可选',
    'common.select': '请选择',
    'common.input': '请输入',
    'common.name': '名称',
    'common.description': '描述',
    'common.status': '状态',
    'common.priority': '优先级',
    'common.date': '日期',
    'common.action': '操作',
    'common.confirm_delete': '确定要删除吗？',
    'common.delete_success': '删除成功',
    'common.create_success': '创建成功',
    'common.update_success': '更新成功',
    'common.submit': '提交',
    'common.yes': '是',
    'common.no': '否',

    // TabBar
    'tab.home': '首页',
    'tab.apps': '应用',
    'tab.profile': '我的',

    // Login
    'login.title': '欢迎登录',
    'login.username': '用户名',
    'login.password': '密码',
    'login.captcha': '验证码',
    'login.submit': '登录',
    'login.forgot': '忘记密码？',
    'login.no_account': '还没有账号？',
    'login.register': '立即注册',
    'login.failed': '登录失败',
    'login.please_enter_username': '请输入用户名',
    'login.please_enter_password': '请输入密码',
    'login.please_enter_captcha': '请输入验证码',

    // Index (Home)
    'home.hi': '您好，',
    'home.welcome': '欢迎回来',
    'home.subtitle': '让管理更高效，让数据更有价值',
    'home.stats.projects': '活跃项目',
    'home.stats.tasks': '待办任务',
    'home.functions': '常用功能',
    'home.view_all': '查看全部',
    'home.announcements': '最新公告',
    'home.announcement.demo1': '2026年度园区安全生产检查通知',
    'home.announcement.demo2': '3号楼变压器运行负载异常提示',
    'home.time.hour': '1小时前',
    'home.time.hours': '3小时前',

    // Apps
    'apps.title': '应用面板',
    'apps.project': '项目管理',
    'apps.task': '任务中心',
    'apps.statistics': '报表统计',
    'apps.cloud': '云存储',
    'apps.park': '园区招商',

    // Profile
    'profile.title': '个人中心',
    'profile.account': '账户设置',
    'profile.security': '安全中心',
    'profile.settings': '通用设置',
    'profile.about': '关于系统',
    'profile.logout': '退出当前账号',
    'profile.logout.confirm': '确定要退出登录吗？',
    'profile.edit.title': '编辑资料',
    'profile.password.title': '修改密码',
    'profile.no_other_company': '暂无其他企业',
    'profile.switch_success': '切换成功',
    'profile.switch_failed': '切换失败',
    'profile.switching': '切换中...',
    'profile.loading_companies': '加载中...',
    'profile.failed_to_load_companies': '获取列表失败',
    'profile.admin': '管理员',
    'profile.personal': '个人',
    'profile.current': '当前',
    'profile.about.content': 'Aspire Admin v1.0.0\n企业级微服务管理平台移动端',
    'profile.upload_avatar': '上传头像',
    'profile.image_too_large': '图片过大，请使用5MB以内的图片',
    'profile.modify_success': '修改成功',
    'profile.upload_success': '上传成功',
    'profile.upload_failed': '上传失败',
    'profile.no_avatar_url': '上传成功但未获取到地址',
    'profile.upload_response_error': '上传响应异常',
    'profile.network_error': '网络错误',

    // Settings
    'settings.title': '通用设置',
    'settings.language': '多语言',
    'settings.language.chinese': '简体中文',
    'settings.language.english': 'English',
    'settings.cache': '清理缓存',
    'settings.cache.msg': '确定要清理本地缓存吗？',
    'settings.cache.success': '清理成功',
    'settings.version': '版本信息',

    // Project
    'project.list.title': '项目列表',
    'project.create.title': '新增项目',
    'project.detail.title': '项目详情',
    'project.status.planning': '规划中',
    'project.status.in_progress': '进行中',
    'project.status.paused': '暂停',
    'project.status.completed': '已完成',
    'project.status.cancelled': '已取消',
    'project.priority.low': '低',
    'project.priority.medium': '中',
    'project.priority.high': '高',
    'project.name_required': '项目名称必填',
    'project.create.success': '创建成功',
    'project.create.failed': '创建失败',
    'project.name': '项目名称',
    'project.budget': '预算',
    'project.start_date': '开始日期',
    'project.end_date': '结束日期',

    // Task
    'task.list.title': '任务中心',
    'task.create.title': '分配任务',
    'task.detail.title': '任务详情',
    'task.status.todo': '待处理',
    'task.status.doing': '进行中',
    'task.status.done': '已完成',
    'task.status.assigned': '已分配',
    'task.status.in_progress': '执行中',
    'task.status.completed': '已完成',
    'task.status.paused': '已暂停',
    'task.status.failed': '已失败',
    'task.status.cancelled': '已取消',
    'task.priority.low': '低',
    'task.priority.medium': '中',
    'task.priority.high': '高',
    'task.priority.urgent': '紧急',
    'task.type.dev': '开发',
    'task.type.design': '设计',
    'task.type.test': '测试',
    'task.type.doc': '文档',
    'task.type.other': '其他',
    'task.name_required': '任务名称必填',
    'task.create.success': '发布成功',
    'task.create.failed': '发布失败',
    'task.name': '任务名称',
    'task.assigned_to': '负责人',
    'task.related_project': '关联项目',
    'task.type': '任务类型',
    'task.planned_start': '计划开始',
    'task.planned_end': '计划结束',

    // Park Investment
    'park.leads.title': '招商线索',
    'park.leads.detail.title': '线索详情',
    'park.leads.status.all': '全部',
    'park.leads.status.new': '新线索',
    'park.leads.status.following': '跟进中',
    'park.leads.status.qualified': '已成交',
    'park.leads.status.lost': '已丢弃',

    // Statistics
    'stats.title': '报表统计',
    'stats.period.week': '周',
    'stats.period.month': '月',
    'stats.period.quarter': '季',
    'stats.period.year': '年',
    'stats.load_failed': '加载失败',
    'stats.ai_report': 'AI智能报告',
    'stats.ai_report_generating': '报告中...',
    'stats.ai_report_failed': '报告生成失败',
    'stats.ai_report_exception': '生成异常',
    'stats.completion_rate': '完成率',
    'stats.total_projects': '项目总数',
    'stats.completed_projects': '已完成',
    'stats.total_tasks': '任务总数',
    'stats.overdue_tasks': '逾期任务',

    // Cloud Storage
    'cloud.title': '云存储',
    'cloud.load_failed': '加载失败',
    'cloud.create_folder': '新建文件夹',
    'cloud.folder_name': '文件夹名称',
    'cloud.please_enter_name': '请输入名称',
    'cloud.create_success': '创建成功',
    'cloud.create_failed': '创建失败',
    'cloud.rename': '重命名',
    'cloud.delete': '删除',
    'cloud.confirm_delete': '确认删除',
    'cloud.delete_hint': '文件将移动到回收站',
    'cloud.removed': '已移除',
    'cloud.operation_failed': '操作失败',
    'cloud.downloading': '正在下载文件',
    'cloud.download_failed': '下载失败',
    'cloud.preview_not_supported': '不支持该类型预览',
    'cloud.uploading': '上传中',
    'cloud.upload_success': '上传成功',
    'cloud.upload_failed': '上传失败',
    'cloud.upload_exception': '上传异常',
    'cloud.in_development': '功能开发中',

    // Modules
    'module.park.leads': '招商线索',
    'module.park.detail': '线索详情',
    'module.cloud.title': '云存储',
    'module.stats.title': '报表统计'
};

const enUS = {
    // Common
    'common.confirm': 'Confirm',
    'common.cancel': 'Cancel',
    'common.tips': 'Tips',
    'common.loading': 'Loading...',
    'common.success': 'Success',
    'common.fail': 'Failed',
    'common.empty': 'No data',
    'common.search': 'Search',
    'common.save': 'Save',
    'common.delete': 'Delete',
    'common.edit': 'Edit',
    'common.create': 'Create',
    'common.detail': 'Detail',
    'common.all': 'All',
    'common.uploading': 'Uploading...',
    'common.downloading': 'Downloading...',
    'common.processing': 'Processing...',
    'common.required': 'Required',
    'common.optional': 'Optional',
    'common.select': 'Please select',
    'common.input': 'Please input',
    'common.name': 'Name',
    'common.description': 'Description',
    'common.status': 'Status',
    'common.priority': 'Priority',
    'common.date': 'Date',
    'common.action': 'Action',
    'common.confirm_delete': 'Are you sure you want to delete?',
    'common.delete_success': 'Deleted successfully',
    'common.create_success': 'Created successfully',
    'common.update_success': 'Updated successfully',
    'common.submit': 'Submit',
    'common.yes': 'Yes',
    'common.no': 'No',

    // TabBar
    'tab.home': 'Home',
    'tab.apps': 'Apps',
    'tab.profile': 'Profile',

    // Login
    'login.title': 'Welcome Back',
    'login.username': 'Username',
    'login.password': 'Password',
    'login.captcha': 'Captcha',
    'login.submit': 'Login',
    'login.forgot': 'Forgot Password?',
    'login.no_account': 'No account?',
    'login.register': 'Register',
    'login.failed': 'Login Failed',
    'login.please_enter_username': 'Please enter username',
    'login.please_enter_password': 'Please enter password',
    'login.please_enter_captcha': 'Please enter captcha',

    // Index (Home)
    'home.hi': 'Hi, ',
    'home.welcome': 'Welcome back',
    'home.subtitle': 'Efficient Management, Valuable Data',
    'home.stats.projects': 'Active Projects',
    'home.stats.tasks': 'My Tasks',
    'home.functions': 'Quick Actions',
    'home.view_all': 'View All',
    'home.announcements': 'Recent Announcements',
    'home.announcement.demo1': 'Park Safety Inspection Notice 2026',
    'home.announcement.demo2': 'Transformer Load Alert (Building 3)',
    'home.time.hour': '1 hour ago',
    'home.time.hours': '3 hours ago',

    // Apps
    'apps.title': 'App Panel',
    'apps.project': 'Projects',
    'apps.task': 'Tasks',
    'apps.statistics': 'Statistics',
    'apps.cloud': 'Cloud',
    'apps.park': 'Park',

    // Profile
    'profile.title': 'Profile',
    'profile.account': 'Account',
    'profile.security': 'Security',
    'profile.settings': 'Settings',
    'profile.about': 'About',
    'profile.logout': 'Logout',
    'profile.logout.confirm': 'Are you sure you want to logout?',
    'profile.edit.title': 'Edit Profile',
    'profile.password.title': 'Change Password',
    'profile.no_other_company': 'No other companies',
    'profile.switch_success': 'Switched successfully',
    'profile.switch_failed': 'Switch failed',
    'profile.switching': 'Switching...',
    'profile.loading_companies': 'Loading...',
    'profile.failed_to_load_companies': 'Failed to load list',
    'profile.admin': 'Admin',
    'profile.personal': 'Personal',
    'profile.current': 'Current',
    'profile.about.content': 'Aspire Admin v1.0.0\nEnterprise Microservices Management Platform',
    'profile.upload_avatar': 'Upload Avatar',
    'profile.image_too_large': 'Image too large, please use images under 5MB',
    'profile.modify_success': 'Modified successfully',
    'profile.upload_success': 'Uploaded successfully',
    'profile.upload_failed': 'Upload failed',
    'profile.no_avatar_url': 'Uploaded successfully but no address obtained',
    'profile.upload_response_error': 'Upload response error',
    'profile.network_error': 'Network error',

    // Settings
    'settings.title': 'General Settings',
    'settings.language': 'Language',
    'settings.language.chinese': '简体中文',
    'settings.language.english': 'English',
    'settings.cache': 'Clear Cache',
    'settings.cache.msg': 'Are you sure you want to clear the local cache?',
    'settings.cache.success': 'Cache cleared',
    'settings.version': 'Version',

    // Project
    'project.list.title': 'Projects',
    'project.create.title': 'Create Project',
    'project.detail.title': 'Project Detail',
    'project.status.planning': 'Planning',
    'project.status.in_progress': 'In Progress',
    'project.status.paused': 'Paused',
    'project.status.completed': 'Completed',
    'project.status.cancelled': 'Cancelled',
    'project.priority.low': 'Low',
    'project.priority.medium': 'Medium',
    'project.priority.high': 'High',
    'project.name_required': 'Project name is required',
    'project.create.success': 'Created successfully',
    'project.create.failed': 'Create failed',
    'project.name': 'Project Name',
    'project.budget': 'Budget',
    'project.start_date': 'Start Date',
    'project.end_date': 'End Date',

    // Task
    'task.list.title': 'Task Center',
    'task.create.title': 'Assign Task',
    'task.detail.title': 'Task Detail',
    'task.status.todo': 'To Do',
    'task.status.doing': 'In Progress',
    'task.status.done': 'Done',
    'task.status.assigned': 'Assigned',
    'task.status.in_progress': 'In Progress',
    'task.status.completed': 'Completed',
    'task.status.paused': 'Paused',
    'task.status.failed': 'Failed',
    'task.status.cancelled': 'Cancelled',
    'task.priority.low': 'Low',
    'task.priority.medium': 'Medium',
    'task.priority.high': 'High',
    'task.priority.urgent': 'Urgent',
    'task.type.dev': 'Development',
    'task.type.design': 'Design',
    'task.type.test': 'Testing',
    'task.type.doc': 'Documentation',
    'task.type.other': 'Other',
    'task.name_required': 'Task name is required',
    'task.create.success': 'Published successfully',
    'task.create.failed': 'Publish failed',
    'task.name': 'Task Name',
    'task.assigned_to': 'Assignee',
    'task.related_project': 'Related Project',
    'task.type': 'Task Type',
    'task.planned_start': 'Planned Start',
    'task.planned_end': 'Planned End',

    // Park Investment
    'park.leads.title': 'Investment Leads',
    'park.leads.detail.title': 'Lead Detail',
    'park.leads.status.all': 'All',
    'park.leads.status.new': 'New',
    'park.leads.status.following': 'Following',
    'park.leads.status.qualified': 'Qualified',
    'park.leads.status.lost': 'Lost',

    // Statistics
    'stats.title': 'Statistics',
    'stats.period.week': 'Week',
    'stats.period.month': 'Month',
    'stats.period.quarter': 'Quarter',
    'stats.period.year': 'Year',
    'stats.load_failed': 'Load failed',
    'stats.ai_report': 'AI Report',
    'stats.ai_report_generating': 'Generating report...',
    'stats.ai_report_failed': 'Report generation failed',
    'stats.ai_report_exception': 'Generation exception',
    'stats.completion_rate': 'Completion Rate',
    'stats.total_projects': 'Total Projects',
    'stats.completed_projects': 'Completed',
    'stats.total_tasks': 'Total Tasks',
    'stats.overdue_tasks': 'Overdue Tasks',

    // Cloud Storage
    'cloud.title': 'Cloud Storage',
    'cloud.load_failed': 'Load failed',
    'cloud.create_folder': 'New Folder',
    'cloud.folder_name': 'Folder Name',
    'cloud.please_enter_name': 'Please enter name',
    'cloud.create_success': 'Created successfully',
    'cloud.create_failed': 'Create failed',
    'cloud.rename': 'Rename',
    'cloud.delete': 'Delete',
    'cloud.confirm_delete': 'Confirm Delete',
    'cloud.delete_hint': 'File will be moved to recycle bin',
    'cloud.removed': 'Removed',
    'cloud.operation_failed': 'Operation failed',
    'cloud.downloading': 'Downloading file...',
    'cloud.download_failed': 'Download failed',
    'cloud.preview_not_supported': 'Preview not supported for this type',
    'cloud.uploading': 'Uploading',
    'cloud.upload_success': 'Uploaded successfully',
    'cloud.upload_failed': 'Upload failed',
    'cloud.upload_exception': 'Upload exception',
    'cloud.in_development': 'Feature in development',

    // Modules
    'module.park.leads': 'Investment Leads',
    'module.park.detail': 'Lead Detail',
    'module.cloud.title': 'Cloud Storage',
    'module.stats.title': 'Statistics'
};

let currentLocale = wx.getStorageSync('locale') || 'zh-CN';
const locales = {
    'zh-CN': zhCN,
    'en-US': enUS
};

const t = (key) => {
    return locales[currentLocale][key] || key;
};

const getTranslations = () => {
    return locales[currentLocale];
};

const setLocale = (locale) => {
    if (locales[locale]) {
        currentLocale = locale;
        wx.setStorageSync('locale', locale);
        return true;
    }
    return false;
};

const getLocale = () => currentLocale;

/**
 * Multiple language support wrapper (HOC)
 * @param {Object} pageConfig Page configuration object
 * @returns {Object} Wrapped page configuration
 */
const withI18n = (pageConfig) => {
    const originalOnShow = pageConfig.onShow;

    pageConfig.onShow = function (...args) {
        // Update translations in data
        this.setData({
            t: getTranslations()
        });

        // Update navigation bar title if defined in data or default keys
        const titleKey = this.data.i18nTitleKey;
        if (titleKey) {
            wx.setNavigationBarTitle({
                title: t(titleKey)
            });
        }

        if (originalOnShow) {
            return originalOnShow.apply(this, args);
        }
    };

    return pageConfig;
};

module.exports = {
    t,
    setLocale,
    getLocale,
    getTranslations,
    withI18n
};
